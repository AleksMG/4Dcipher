<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OctoKEM Pro - –ü–æ—Å—Ç–∫–≤–∞–Ω—Ç–æ–≤–∞—è –∫—Ä–∏–ø—Ç–æ—Å–∏—Å—Ç–µ–º–∞</title>
    <style>
        :root {
            --primary-dark: #1a237e;
            --primary: #303f9f;
            --primary-light: #7986cb;
            --secondary-dark: #00897b;
            --secondary: #00acc1;
            --secondary-light: #4dd0e1;
            --accent: #ff5722;
            --error-dark: #c62828;
            --error: #f44336;
            --error-light: #ffcdd2;
            --success-dark: #2e7d32;
            --success: #4caf50;
            --success-light: #c8e6c9;
            --warning-dark: #f57c00;
            --warning: #ff9800;
            --warning-light: #ffe0b2;
            --background-dark: #121212;
            --background: #f5f5f5;
            --surface-dark: #1e1e1e;
            --surface: #ffffff;
            --surface-light: #f5f5f5;
            --text-primary: #212121;
            --text-secondary: #757575;
            --text-on-primary: #ffffff;
            --text-on-secondary: #000000;
            --text-on-error: #ffffff;
            --text-on-success: #ffffff;
            --text-on-warning: #000000;
            --border-dark: #424242;
            --border: #e0e0e0;
            --border-light: #f5f5f5;
            --disabled: #9e9e9e;
            --disabled-bg: #e0e0e0;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --shadow-md: 0 6px 10px rgba(0, 0, 0, 0.15);
            --shadow-lg: 0 10px 15px rgba(0, 0, 0, 0.2);
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --primary: #303f9f;
                --secondary: #00acc1;
                --accent: #ff5722;
                --error: #f44336;
                --success: #4caf50;
                --warning: #ff9800;
                --background: #121212;
                --surface: #1e1e1e;
                --text-primary: #ffffff;
                --text-secondary: #b0b0b0;
                --text-on-primary: #ffffff;
                --text-on-secondary: #000000;
                --border: #424242;
                --disabled: #666666;
                --disabled-bg: #333333;
                --shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
                --shadow-md: 0 6px 10px rgba(0, 0, 0, 0.4);
                --shadow-lg: 0 10px 15px rgba(0, 0, 0, 0.5);
            }
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Roboto', 'Segoe UI', -apple-system, BlinkMacSystemFont, sans-serif;
            line-height: 1.6;
            color: var(--text-primary);
            background-color: var(--background);
            margin: 0;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            flex: 1;
        }

        h1, h2, h3, h4, h5, h6 {
            color: var(--primary);
            margin-top: 0;
            font-weight: 500;
        }

        h1 {
            font-size: 2.2rem;
            border-bottom: 2px solid var(--accent);
            padding-bottom: 10px;
            margin-bottom: 20px;
        }

        h2 {
            font-size: 1.8rem;
            margin-bottom: 15px;
        }

        h3 {
            font-size: 1.4rem;
            margin-bottom: 10px;
        }

        .card {
            background-color: var(--surface);
            border-radius: 8px;
            box-shadow: var(--shadow);
            padding: 24px;
            margin-bottom: 24px;
            border: 1px solid var(--border);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--border);
        }

        .tabs {
            display: flex;
            margin-bottom: -1px;
            overflow-x: auto;
            scrollbar-width: none;
        }

        .tabs::-webkit-scrollbar {
            display: none;
        }

        .tab {
            padding: 12px 24px;
            background: var(--surface-light);
            border: 1px solid var(--border);
            border-bottom: none;
            border-radius: 8px 8px 0 0;
            cursor: pointer;
            margin-right: 4px;
            transition: all 0.3s ease;
            white-space: nowrap;
            font-weight: 500;
        }

        .tab:hover {
            background-color: var(--primary-light);
            color: var(--text-on-primary);
        }

        .tab.active {
            background: var(--surface);
            border-bottom: 1px solid var(--surface);
            font-weight: 600;
            color: var(--primary);
            border-top: 3px solid var(--accent);
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .tab-content.active {
            display: block;
        }

        textarea, input, select {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--border);
            border-radius: 4px;
            font-family: 'Roboto Mono', monospace;
            margin-bottom: 12px;
            resize: vertical;
            background-color: var(--surface);
            color: var(--text-primary);
            transition: border 0.3s ease;
        }

        textarea {
            min-height: 120px;
        }

        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 2px var(--primary-light);
        }

        button {
            background-color: var(--primary);
            color: var(--text-on-primary);
            border: none;
            padding: 12px 24px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            transition: all 0.3s ease;
            margin-right: 8px;
            margin-bottom: 8px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }

        button:hover {
            background-color: var(--primary-dark);
            transform: translateY(-1px);
            box-shadow: var(--shadow-md);
        }

        button:active {
            transform: translateY(0);
            box-shadow: var(--shadow);
        }

        button:disabled {
            background-color: var(--disabled-bg);
            color: var(--disabled);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        button.secondary {
            background-color: var(--secondary);
            color: var(--text-on-secondary);
        }

        button.secondary:hover {
            background-color: var(--secondary-dark);
        }

        button.danger {
            background-color: var(--error);
            color: var(--text-on-error);
        }

        button.danger:hover {
            background-color: var(--error-dark);
        }

        button.success {
            background-color: var(--success);
            color: var(--text-on-success);
        }

        button.success:hover {
            background-color: var(--success-dark);
        }

        button.warning {
            background-color: var(--warning);
            color: var(--text-on-warning);
        }

        button.warning:hover {
            background-color: var(--warning-dark);
        }

        .button-group {
            margin: 16px 0;
            display: flex;
            flex-wrap: wrap;
        }

        .button-group.center {
            justify-content: center;
        }

        .output-container {
            position: relative;
            margin-bottom: 16px;
        }

        .output-container label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--text-secondary);
        }

        .copy-btn {
            position: absolute;
            top: 34px;
            right: 10px;
            padding: 6px 12px;
            background-color: var(--primary-light);
            color: var(--text-on-primary);
            font-size: 12px;
            border-radius: 4px;
            border: none;
            cursor: pointer;
            opacity: 0.8;
            transition: opacity 0.3s ease;
        }

        .copy-btn:hover {
            opacity: 1;
        }

        .alert {
            padding: 16px;
            border-radius: 4px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from { transform: translateX(20px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        .alert-success {
            background-color: var(--success-light);
            color: var(--success-dark);
            border-left: 4px solid var(--success);
        }

        .alert-error {
            background-color: var(--error-light);
            color: var(--error-dark);
            border-left: 4px solid var(--error);
        }

        .alert-warning {
            background-color: var(--warning-light);
            color: var(--warning-dark);
            border-left: 4px solid var(--warning);
        }

        .alert-info {
            background-color: var(--secondary-light);
            color: var(--secondary-dark);
            border-left: 4px solid var(--secondary);
        }

        .alert-icon {
            margin-right: 12px;
            font-size: 24px;
        }

        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }

        .setting-group {
            margin-bottom: 20px;
        }

        .setting-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--text-secondary);
        }

        .progress-container {
            margin: 20px 0;
        }

        progress {
            width: 100%;
            height: 24px;
            border-radius: 4px;
            overflow: hidden;
            appearance: none;
            -webkit-appearance: none;
        }

        progress::-webkit-progress-bar {
            background-color: var(--border);
            border-radius: 4px;
        }

        progress::-webkit-progress-value {
            background-color: var(--primary);
            border-radius: 4px;
        }

        progress::-moz-progress-bar {
            background-color: var(--primary);
            border-radius: 4px;
        }

        .status {
            font-style: italic;
            color: var(--text-secondary);
            margin-top: 8px;
        }

        .security-level-indicator {
            padding: 8px 12px;
            background-color: var(--success-light);
            color: var(--success-dark);
            border-radius: 4px;
            display: inline-flex;
            align-items: center;
            margin-bottom: 16px;
            font-weight: 500;
        }

        .security-level-indicator .icon {
            margin-right: 8px;
        }

        .key-visualization {
            display: flex;
            flex-wrap: wrap;
            gap: 4px;
            margin: 12px 0;
        }

        .key-bit {
            width: 16px;
            height: 16px;
            border-radius: 2px;
            background-color: var(--primary);
            opacity: 0.7;
            transition: all 0.3s ease;
        }

        .key-bit:hover {
            opacity: 1;
            transform: scale(1.2);
        }

        .performance-metrics {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 16px;
            margin-top: 16px;
        }

        .metric-card {
            background-color: var(--surface);
            border-radius: 8px;
            padding: 16px;
            border-left: 4px solid var(--primary);
            box-shadow: var(--shadow);
        }

        .metric-value {
            font-size: 1.8rem;
            font-weight: 600;
            color: var(--primary);
        }

        .metric-label {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .crypto-analysis-result {
            margin-top: 16px;
            padding: 16px;
            background-color: var(--surface);
            border-radius: 8px;
            border-left: 4px solid var(--accent);
            box-shadow: var(--shadow);
        }

        .analysis-metric {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            padding-bottom: 8px;
            border-bottom: 1px dashed var(--border);
        }

        .analysis-metric:last-child {
            margin-bottom: 0;
            padding-bottom: 0;
            border-bottom: none;
        }

        .metric-name {
            font-weight: 500;
        }

        .metric-value {
            font-family: 'Roboto Mono', monospace;
        }

        .good {
            color: var(--success);
        }

        .fair {
            color: var(--warning);
        }

        .poor {
            color: var(--error);
        }

        @media (max-width: 768px) {
            .settings-grid {
                grid-template-columns: 1fr;
            }
            
            .performance-metrics {
                grid-template-columns: 1fr;
            }
            
            .tabs {
                flex-wrap: nowrap;
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
            }
            
            .tab {
                padding: 12px 16px;
                font-size: 0.9rem;
            }
            
            button {
                width: 100%;
                margin-right: 0;
            }
        }

        /* –ê–Ω–∏–º–∞—Ü–∏–∏ */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: var(--text-on-primary);
            animation: spin 1s ease-in-out infinite;
            margin-right: 8px;
        }

        /* –ò–∫–æ–Ω–∫–∏ */
        .icon {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 24px;
            height: 24px;
            margin-right: 8px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>OctoKEM Pro - –£—Å–æ–≤–µ—Ä—à–µ–Ω—Å—Ç–≤–æ–≤–∞–Ω–Ω–∞—è –ø–æ—Å—Ç–∫–≤–∞–Ω—Ç–æ–≤–∞—è –∫—Ä–∏–ø—Ç–æ—Å–∏—Å—Ç–µ–º–∞</h1>
        
        <div class="tabs">
            <div class="tab active" onclick="switchTab('kem')">–û–±–º–µ–Ω –∫–ª—é—á–∞–º–∏ (KEM)</div>
            <div class="tab" onclick="switchTab('encrypt')">–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ</div>
            <div class="tab" onclick="switchTab('settings')">–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏</div>
            <div class="tab" onclick="switchTab('analysis')">–ö—Ä–∏–ø—Ç–æ–∞–Ω–∞–ª–∏–∑</div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞ KEM -->
        <div id="kem" class="tab-content active">
            <div class="card">
                <h2>–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–µ–≤–æ–π –ø–∞—Ä—ã</h2>
                <div class="security-level-indicator">
                    <span class="icon">üîí</span>
                    <span id="securityLevel">–£—Ä–æ–≤–µ–Ω—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏: –í—ã—Å–æ–∫–∏–π (256-–±–∏—Ç)</span>
                </div>
                
                <div class="button-group">
                    <button id="generateKeysBtn" onclick="generateEnhancedKeyPair()">
                        <span class="icon">üîÑ</span>–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–ª—é—á–µ–≤—É—é –ø–∞—Ä—É
                    </button>
                    <button class="secondary" onclick="validateKeyPair()">
                        <span class="icon">‚úÖ</span>–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å
                    </button>
                    <button class="warning" onclick="exportKeyPair()">
                        <span class="icon">üì§</span>–≠–∫—Å–ø–æ—Ä—Ç –∫–ª—é—á–µ–π
                    </button>
                    <button class="danger" onclick="wipeKeyPair()">
                        <span class="icon">‚ö†Ô∏è</span>–£–Ω–∏—á—Ç–æ–∂–∏—Ç—å –∫–ª—é—á–∏
                    </button>
                </div>
                
                <div class="output-container">
                    <label for="publicKey">–ü—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á:</label>
                    <textarea id="publicKey" readonly></textarea>
                    <button class="copy-btn" onclick="copyToClipboard('publicKey')">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
                </div>
                
                <div class="output-container">
                    <label for="privateKey">–ü—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á:</label>
                    <textarea id="privateKey" readonly></textarea>
                    <button class="copy-btn" onclick="copyToClipboard('privateKey')">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
                </div>
                
                <div class="key-visualization" id="keyVisualization">
                    <!-- –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∫–ª—é—á–∞ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                </div>
            </div>
            
            <div class="card">
                <h2>–ò–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏—è –∫–ª—é—á–∞</h2>
                <div class="alert alert-info">
                    <span class="icon">‚ÑπÔ∏è</span>
                    <div>–î–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –æ–±–º–µ–Ω–∞ –∫–ª—é—á–∞–º–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∏–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏—é/–¥–µ–∫–∞–ø—Å—É–ª—è—Ü–∏—é –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ–∫—Ç–æ–Ω–∏–æ–Ω–Ω–æ–≥–æ LWE</div>
                </div>
                
                <div class="output-container">
                    <label for="recipientPublicKey">–ü—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á –ø–æ–ª—É—á–∞—Ç–µ–ª—è:</label>
                    <textarea id="recipientPublicKey" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á –ø–æ–ª—É—á–∞—Ç–µ–ª—è –∏–ª–∏ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –∏–∑ —Ñ–∞–π–ª–∞"></textarea>
                </div>
                
                <div class="button-group">
                    <button class="success" onclick="encapsulateKey()">
                        <span class="icon">üîê</span>–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –æ–±—â–∏–π –∫–ª—é—á
                    </button>
                    <button class="secondary" onclick="importPublicKey()">
                        <span class="icon">üì•</span>–ò–º–ø–æ—Ä—Ç –∫–ª—é—á–∞
                    </button>
                </div>
                
                <div class="output-container">
                    <label for="sharedSecret">–û–±—â–∏–π —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á:</label>
                    <textarea id="sharedSecret" readonly></textarea>
                    <button class="copy-btn" onclick="copyToClipboard('sharedSecret')">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
                </div>
                
                <div class="output-container">
                    <label for="encapsulatedKey">–ò–Ω–∫–∞–ø—Å—É–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–ª—é—á (–¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏):</label>
                    <textarea id="encapsulatedKey" readonly></textarea>
                    <button class="copy-btn" onclick="copyToClipboard('encapsulatedKey')">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
                </div>
            </div>
            
            <div class="card">
                <h2>–î–µ–∫–∞–ø—Å—É–ª—è—Ü–∏—è –∫–ª—é—á–∞</h2>
                <div class="output-container">
                    <label for="receivedEncapsulatedKey">–ü–æ–ª—É—á–µ–Ω–Ω—ã–π –∏–Ω–∫–∞–ø—Å—É–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–ª—é—á:</label>
                    <textarea id="receivedEncapsulatedKey" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–π –∏–Ω–∫–∞–ø—Å—É–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–ª—é—á"></textarea>
                </div>
                
                <div class="button-group">
                    <button class="success" onclick="decapsulateKey()">
                        <span class="icon">üîì</span>–ò–∑–≤–ª–µ—á—å –æ–±—â–∏–π –∫–ª—é—á
                    </button>
                    <button class="secondary" onclick="verifyKeyMatch()">
                        <span class="icon">üîç</span>–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ
                    </button>
                </div>
                
                <div class="output-container">
                    <label for="decapsulatedSecret">–ò–∑–≤–ª–µ—á—ë–Ω–Ω—ã–π —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á:</label>
                    <textarea id="decapsulatedSecret" readonly></textarea>
                    <button class="copy-btn" onclick="copyToClipboard('decapsulatedSecret')">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
                </div>
                
                <div class="performance-metrics" id="kemMetrics">
                    <div class="metric-card">
                        <div class="metric-value" id="kemGenTime">0 –º—Å</div>
                        <div class="metric-label">–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–µ–π</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="kemEncTime">0 –º—Å</div>
                        <div class="metric-label">–ò–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏—è</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="kemDecTime">0 –º—Å</div>
                        <div class="metric-label">–î–µ–∫–∞–ø—Å—É–ª—è—Ü–∏—è</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è -->
        <div id="encrypt" class="tab-content">
            <div class="card">
                <h2>–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö</h2>
                <div class="alert alert-info">
                    <span class="icon">‚ÑπÔ∏è</span>
                    <div>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —É–ª—É—á—à–µ–Ω–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ–∫—Ç–æ–Ω–∏–æ–Ω–æ–≤ —Å 12+ —Ä–∞—É–Ω–¥–∞–º–∏</div>
                </div>
                
                <div class="output-container">
                    <label for="plaintext">–ò—Å—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç:</label>
                    <textarea id="plaintext" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è"></textarea>
                </div>
                
                <div class="output-container">
                    <label for="encryptionKey">–ö–ª—é—á —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è (–∏–ª–∏ –æ–±—â–∏–π –∫–ª—é—á –∏–∑ KEM):</label>
                    <textarea id="encryptionKey" placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–ª—é—á –∏–ª–∏ –≤—Å—Ç–∞–≤—å—Ç–µ –æ–±—â–∏–π —Å–µ–∫—Ä–µ—Ç"></textarea>
                </div>
                
                <div class="button-group">
                    <button class="success" onclick="encryptData()">
                        <span class="icon">üîí</span>–ó–∞—à–∏—Ñ—Ä–æ–≤–∞—Ç—å
                    </button>
                    <button class="secondary" onclick="generateRandomKey()">
                        <span class="icon">üé≤</span>–°–ª—É—á–∞–π–Ω—ã–π –∫–ª—é—á
                    </button>
                    <button class="secondary" onclick="loadFileForEncryption()">
                        <span class="icon">üìÅ</span>–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª
                    </button>
                </div>
                
                <div class="output-container">
                    <label for="ciphertext">–†–µ–∑—É–ª—å—Ç–∞—Ç —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è:</label>
                    <textarea id="ciphertext" readonly></textarea>
                    <button class="copy-btn" onclick="copyToClipboard('ciphertext')">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
                </div>
            </div>
            
            <div class="card">
                <h2>–î–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö</h2>
                <div class="output-container">
                    <label for="encryptedData">–ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:</label>
                    <textarea id="encryptedData" placeholder="–í–≤–µ–¥–∏—Ç–µ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ"></textarea>
                </div>
                
                <div class="output-container">
                    <label for="decryptionKey">–ö–ª—é—á –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è:</label>
                    <textarea id="decryptionKey" placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–ª—é—á –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è"></textarea>
                </div>
                
                <div class="button-group">
                    <button class="success" onclick="decryptData()">
                        <span class="icon">üîì</span>–î–µ—à–∏—Ñ—Ä–æ–≤–∞—Ç—å
                    </button>
                    <button class="secondary" onclick="loadFileForDecryption()">
                        <span class="icon">üìÅ</span>–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª
                    </button>
                    <button class="danger" onclick="clearDecryptionFields()">
                        <span class="icon">üóëÔ∏è</span>–û—á–∏—Å—Ç–∏—Ç—å
                    </button>
                </div>
                
                <div class="output-container">
                    <label for="decryptedText">–†–µ–∑—É–ª—å—Ç–∞—Ç –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è:</label>
                    <textarea id="decryptedText" readonly></textarea>
                    <button class="copy-btn" onclick="copyToClipboard('decryptedText')">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
                </div>
                
                <div class="performance-metrics" id="cryptoMetrics">
                    <div class="metric-card">
                        <div class="metric-value" id="encryptTime">0 –º—Å</div>
                        <div class="metric-label">–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="decryptTime">0 –º—Å</div>
                        <div class="metric-label">–î–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="throughput">0 KB/s</div>
                        <div class="metric-label">–ü—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ -->
        <div id="settings" class="tab-content">
            <div class="card">
                <h2>–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∫—Ä–∏–ø—Ç–æ—Å–∏—Å—Ç–µ–º—ã</h2>
                
                <div class="settings-grid">
                    <div class="setting-group">
                        <label for="rounds">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞—É–Ω–¥–æ–≤ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è:</label>
                        <select id="rounds" class="custom-select">
                            <option value="12">12 (–±–∞–ª–∞–Ω—Å —Å–∫–æ—Ä–æ—Å—Ç–∏ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏)</option>
                            <option value="16">16 (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –≤–∞–∂–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö)</option>
                            <option value="20">20 (–º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)</option>
                            <option value="24">24 (–ø–∞—Ä–∞–Ω–æ–∏–¥–∞–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å)</option>
                        </select>
                    </div>
                    
                    <div class="setting-group">
                        <label for="errorSize">–†–∞–∑–º–µ—Ä –æ—à–∏–±–∫–∏ (LWE):</label>
                        <select id="errorSize" class="custom-select">
                            <option value="2">–ú–∞–ª—ã–π (2) - –±—ã—Å—Ç—Ä–µ–µ</option>
                            <option value="3" selected>–°—Ä–µ–¥–Ω–∏–π (3) - —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è</option>
                            <option value="5">–ë–æ–ª—å—à–æ–π (5) - –±–µ–∑–æ–ø–∞—Å–Ω–µ–µ</option>
                            <option value="7">–û—á–µ–Ω—å –±–æ–ª—å—à–æ–π (7) - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –∑–∞—â–∏—Ç–∞</option>
                        </select>
                    </div>
                    
                    <div class="setting-group">
                        <label for="keySize">–†–∞–∑–º–µ—Ä –∫–ª—é—á–∞:</label>
                        <select id="keySize" class="custom-select">
                            <option value="128">128 –±–∏—Ç (–¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)</option>
                            <option value="192">192 –±–∏—Ç (–±–∞–ª–∞–Ω—Å —Å–∫–æ—Ä–æ—Å—Ç–∏ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏)</option>
                            <option value="256" selected>256 –±–∏—Ç (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)</option>
                            <option value="384">384 –±–∏—Ç (–≤—ã—Å–æ–∫–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)</option>
                            <option value="512">512 –±–∏—Ç (–º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –∑–∞—â–∏—Ç–∞)</option>
                        </select>
                    </div>
                    
                    <div class="setting-group">
                        <label for="mode">–†–µ–∂–∏–º —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è:</label>
                        <select id="mode" class="custom-select">
                            <option value="OCB" selected>OCB (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)</option>
                            <option value="GCM">GCM</option>
                            <option value="CBC">CBC (—É—Å—Ç–∞—Ä–µ–≤—à–∏–π)</option>
                            <option value="CTR">CTR</option>
                        </select>
                    </div>
                    
                    <div class="setting-group">
                        <label for="keyDerivation">–§—É–Ω–∫—Ü–∏—è —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –∫–ª—é—á–∞:</label>
                        <select id="keyDerivation" class="custom-select">
                            <option value="HKDF">HKDF (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)</option>
                            <option value="PBKDF2">PBKDF2</option>
                            <option value="Argon2">Argon2 (—Ä–µ—Å—É—Ä—Å–æ—ë–º–∫–∏–π)</option>
                        </select>
                    </div>
                    
                    <div class="setting-group">
                        <label for="hashAlgorithm">–•–µ—à-–∞–ª–≥–æ—Ä–∏—Ç–º:</label>
                        <select id="hashAlgorithm" class="custom-select">
                            <option value="SHA3-256">SHA3-256 (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)</option>
                            <option value="SHA3-512">SHA3-512</option>
                            <option value="SHA-256">SHA-256</option>
                            <option value="BLAKE2s">BLAKE2s</option>
                        </select>
                    </div>
                </div>
                
                <div class="button-group center">
                    <button class="success" onclick="saveSettings()">
                        <span class="icon">üíæ</span>–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
                    </button>
                    <button class="secondary" onclick="resetSettings()">
                        <span class="icon">üîÑ</span>–°–±—Ä–æ—Å–∏—Ç—å –∫ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º
                    </button>
                    <button class="warning" onclick="runPerformanceTest()">
                        <span class="icon">‚ö°</span>–¢–µ—Å—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
                    </button>
                </div>
                
                <div class="progress-container" id="performanceTestContainer" style="display: none;">
                    <h3>–¢–µ—Å—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã</h3>
                    <progress id="performanceProgress" value="0" max="100"></progress>
                    <p class="status" id="performanceStatus">–ì–æ—Ç–æ–≤ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é...</p>
                    
                    <div class="performance-metrics" id="performanceMetrics">
                        <div class="metric-card">
                            <div class="metric-value" id="opsPerSec">0</div>
                            <div class="metric-label">–û–ø–µ—Ä–∞—Ü–∏–π/—Å–µ–∫</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value" id="memoryUsage">0 MB</div>
                            <div class="metric-label">–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value" id="cpuLoad">0%</div>
                            <div class="metric-label">–ù–∞–≥—Ä—É–∑–∫–∞ CPU</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="card">
                <h2>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏</h2>
                
                <div class="settings-grid">
                    <div class="setting-group">
                        <label for="keyExpiration">–°—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è –∫–ª—é—á–µ–π:</label>
                        <select id="keyExpiration" class="custom-select">
                            <option value="0">–ù–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω</option>
                            <option value="86400">1 –¥–µ–Ω—å</option>
                            <option value="604800" selected>1 –Ω–µ–¥–µ–ª—è</option>
                            <option value="2592000">1 –º–µ—Å—è—Ü</option>
                            <option value="31536000">1 –≥–æ–¥</option>
                        </select>
                    </div>
                    
                    <div class="setting-group">
                        <label for="maxKeyUsage">–ú–∞–∫—Å. –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π –∫–ª—é—á–∞:</label>
                        <select id="maxKeyUsage" class="custom-select">
                            <option value="0">–ù–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω</option>
                            <option value="100">100 —Ä–∞–∑</option>
                            <option value="1000" selected>1000 —Ä–∞–∑</option>
                            <option value="10000">10,000 —Ä–∞–∑</option>
                        </select>
                    </div>
                    
                    <div class="setting-group">
                        <label for="keyWipePolicy">–ü–æ–ª–∏—Ç–∏–∫–∞ —É–Ω–∏—á—Ç–æ–∂–µ–Ω–∏—è –∫–ª—é—á–µ–π:</label>
                        <select id="keyWipePolicy" class="custom-select">
                            <option value="session">–ü–æ—Å–ª–µ —Å–µ–∞–Ω—Å–∞</option>
                            <option value="memory" selected>–ü—Ä–∏ –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏</option>
                            <option value="immediate">–ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ –ø–æ—Å–ª–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</option>
                        </select>
                    </div>
                    
                    <div class="setting-group">
                        <label for="entropySource">–ò—Å—Ç–æ—á–Ω–∏–∫ —ç–Ω—Ç—Ä–æ–ø–∏–∏:</label>
                        <select id="entropySource" class="custom-select">
                            <option value="crypto">Crypto API</option>
                            <option value="mixed" selected>–°–º–µ—à–∞–Ω–Ω—ã–π (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)</option>
                            <option value="hardware">–ê–ø–ø–∞—Ä–∞—Ç–Ω—ã–π (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω)</option>
                        </select>
                    </div>
                </div>
                
                <div class="button-group center">
                    <button class="success" onclick="applySecurityPolicy()">
                        <span class="icon">üõ°Ô∏è</span>–ü—Ä–∏–º–µ–Ω–∏—Ç—å –ø–æ–ª–∏—Ç–∏–∫—É –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
                    </button>
                    <button class="secondary" onclick="showSecurityRecommendations()">
                        <span class="icon">üìã</span>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
                    </button>
                </div>
            </div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞ –∫—Ä–∏–ø—Ç–æ–∞–Ω–∞–ª–∏–∑–∞ -->
        <div id="analysis" class="tab-content">
            <div class="card">
                <h2>–ê–Ω–∞–ª–∏–∑ –∫—Ä–∏–ø—Ç–æ—Å—Ç–æ–π–∫–æ—Å—Ç–∏</h2>
                <div class="alert alert-info">
                    <span class="icon">‚ÑπÔ∏è</span>
                    <div>–≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–∏—Å—Ç–µ–º—ã –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏–∏</div>
                </div>
                
                <div class="button-group">
                    <button class="success" onclick="runFullAnalysis()">
                        <span class="icon">üîç</span>–í—ã–ø–æ–ª–Ω–∏—Ç—å –ø–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑
                    </button>
                    <button class="secondary" onclick="testRandomness()">
                        <span class="icon">üé≤</span>–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–ª—É—á–∞–π–Ω–æ—Å—Ç—å
                    </button>
                    <button class="secondary" onclick="testEntropy()">
                        <span class="icon">üå™Ô∏è</span>–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —ç–Ω—Ç—Ä–æ–ø–∏—é
                    </button>
                </div>
                
                <div class="crypto-analysis-result" id="analysisResult" style="display: none;">
                    <h3>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞</h3>
                    <div class="analysis-metric">
                        <span class="metric-name">–û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:</span>
                        <span class="metric-value" id="overallScore">-</span>
                    </div>
                    <div class="analysis-metric">
                        <span class="metric-name">–°—Ç–æ–π–∫–æ—Å—Ç—å –∫ –∫–≤–∞–Ω—Ç–æ–≤—ã–º –∞—Ç–∞–∫–∞–º:</span>
                        <span class="metric-value" id="quantumResistance">-</span>
                    </div>
                    <div class="analysis-metric">
                        <span class="metric-name">–°—Ç–æ–π–∫–æ—Å—Ç—å –∫ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–º –∞—Ç–∞–∫–∞–º:</span>
                        <span class="metric-value" id="classicalResistance">-</span>
                    </div>
                    <div class="analysis-metric">
                        <span class="metric-name">–ö–∞—á–µ—Å—Ç–≤–æ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–ª—é—á–µ–π:</span>
                        <span class="metric-value" id="keyQuality">-</span>
                    </div>
                    <div class="analysis-metric">
                        <span class="metric-name">–≠–Ω—Ç—Ä–æ–ø–∏—è –∫–ª—é—á–µ–≤–æ–≥–æ –º–∞—Ç–µ—Ä–∏–∞–ª–∞:</span>
                        <span class="metric-value" id="entropyScore">-</span>
                    </div>
                    <div class="analysis-metric">
                        <span class="metric-name">–°—Ç–æ–π–∫–æ—Å—Ç—å –∫ –∞—Ç–∞–∫–∞–º –ø–æ –≤—Ä–µ–º–µ–Ω–∏:</span>
                        <span class="metric-value" id="timingAttackResistance">-</span>
                    </div>
                    <div class="analysis-metric">
                        <span class="metric-name">–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é:</span>
                        <span class="metric-value" id="recommendations">-</span>
                    </div>
                </div>
                
                <div class="progress-container" id="analysisProgressContainer" style="display: none;">
                    <h3>–í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∞–Ω–∞–ª–∏–∑...</h3>
                    <progress id="analysisProgress" value="0" max="100"></progress>
                    <p class="status" id="analysisStatus">–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä–∞...</p>
                </div>
            </div>
            
            <div class="card">
                <h2>–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π</h2>
                
                <div class="button-group">
                    <button class="warning" onclick="testSideChannels()">
                        <span class="icon">üïµÔ∏è</span>–ü—Ä–æ–≤–µ—Ä–∏—Ç—å side-channel —É—è–∑–≤–∏–º–æ—Å—Ç–∏
                    </button>
                    <button class="warning" onclick="testPaddingOracle()">
                        <span class="icon">üîì</span>–ü—Ä–æ–≤–µ—Ä–∏—Ç—å Padding Oracle
                    </button>
                    <button class="danger" onclick="testBruteForce()">
                        <span class="icon">üí•</span>–¢–µ—Å—Ç –Ω–∞ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ brute-force
                    </button>
                </div>
                
                <div class="output-container">
                    <label for="vulnerabilityReport">–û—Ç—á—ë—Ç –æ–± —É—è–∑–≤–∏–º–æ—Å—Ç—è—Ö:</label>
                    <textarea id="vulnerabilityReport" readonly></textarea>
                    <button class="copy-btn" onclick="copyToClipboard('vulnerabilityReport')">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
                </div>
            </div>
            
            <div class="card">
                <h2>–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –¥—Ä—É–≥–∏–º–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞–º–∏</h2>
                
                <div class="button-group">
                    <button class="secondary" onclick="compareWithAES()">
                        <span class="icon">üîÄ</span>–°—Ä–∞–≤–Ω–∏—Ç—å —Å AES
                    </button>
                    <button class="secondary" onclick="compareWithKyber()">
                        <span class="icon">üîÄ</span>–°—Ä–∞–≤–Ω–∏—Ç—å —Å Kyber
                    </button>
                    <button class="secondary" onclick="compareWithRSA()">
                        <span class="icon">üîÄ</span>–°—Ä–∞–≤–Ω–∏—Ç—å —Å RSA
                    </button>
                </div>
                
                <div class="output-container">
                    <label for="comparisonReport">–û—Ç—á—ë—Ç –æ —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏:</label>
                    <textarea id="comparisonReport" readonly></textarea>
                    <button class="copy-btn" onclick="copyToClipboard('comparisonReport')">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
                </div>
            </div>
        </div>
        
        <div id="alertContainer"></div>
    </div>

    <script>
        // =============================================
        // –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï –ò –ö–û–ù–°–¢–ê–ù–¢–´
        // =============================================
        
        // –í–µ—Ä—Å–∏—è —Å–∏—Å—Ç–µ–º—ã
        const OCTOKEM_VERSION = "2.0.0";
        
        // –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
        const DEFAULT_SETTINGS = {
            rounds: 16,
            errorSize: 3,
            keySize: 256,
            mode: 'OCB',
            keyDerivation: 'HKDF',
            hashAlgorithm: 'SHA3-256',
            keyExpiration: 604800,
            maxKeyUsage: 1000,
            keyWipePolicy: 'memory',
            entropySource: 'mixed'
        };
        
        // –°–æ—Å—Ç–æ—è–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã
        const systemState = {
            currentKeyPair: null,
            keyUsageCount: 0,
            lastKeyUsageTime: null,
            securityLevel: 'high',
            performanceMetrics: {
                kemGeneration: 0,
                kemEncapsulation: 0,
                kemDecapsulation: 0,
                encryption: 0,
                decryption: 0
            },
            analysisResults: null,
            settings: {...DEFAULT_SETTINGS}
        };
        
        // =============================================
        // –û–°–ù–û–í–ù–´–ï –ö–õ–ê–°–°–´ –°–ò–°–¢–ï–ú–´
        // =============================================
        
        /**
         * –ö–ª–∞—Å—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –æ–∫—Ç–æ–Ω–∏–æ–Ω–∞–º–∏
         * –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∏ –∑–∞—â–∏—â—ë–Ω–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
         */
        class SecureOctonion {
            constructor(e0 = 0, e1 = 0, e2 = 0, e3 = 0, e4 = 0, e5 = 0, e6 = 0, e7 = 0) {
                // –ò—Å–ø–æ–ª—å–∑—É–µ–º TypedArray –¥–ª—è –ª—É—á—à–µ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
                this.coefficients = new Float64Array(8);
                this.coefficients[0] = this.sanitizeInput(e0);
                this.coefficients[1] = this.sanitizeInput(e1);
                this.coefficients[2] = this.sanitizeInput(e2);
                this.coefficients[3] = this.sanitizeInput(e3);
                this.coefficients[4] = this.sanitizeInput(e4);
                this.coefficients[5] = this.sanitizeInput(e5);
                this.coefficients[6] = this.sanitizeInput(e6);
                this.coefficients[7] = this.sanitizeInput(e7);
                
                // –ó–∞—â–∏—Ç–∞ –æ—Ç timing-–∞—Ç–∞–∫
                this.constantTimeCheck();
            }
            
            // –°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –≤–≤–æ–¥–∞
            sanitizeInput(value) {
                if (typeof value !== 'number' || isNaN(value) || !isFinite(value)) {
                    throw new Error("–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ –æ–∫—Ç–æ–Ω–∏–æ–Ω–∞");
                }
                return value;
            }
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
            constantTimeCheck() {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –≤—Å–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã —è–≤–ª—è—é—Ç—Å—è —á–∏—Å–ª–∞–º–∏
                let isValid = true;
                for (let i = 0; i < 8; i++) {
                    // –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø–æ–±–∏—Ç–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
                    isValid &= (typeof this.coefficients[i] === 'number');
                }
                if (!isValid) {
                    throw new Error("–û–∫—Ç–æ–Ω–∏–æ–Ω —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã");
                }
            }
            
            // –û–ø–µ—Ä–∞—Ü–∏—è —Å–ª–æ–∂–µ–Ω–∏—è
            add(other) {
                this.validateOctonion(other);
                const result = new Float64Array(8);
                for (let i = 0; i < 8; i++) {
                    result[i] = this.coefficients[i] + other.coefficients[i];
                }
                return new SecureOctonion(...result);
            }
            
            // –û–ø–µ—Ä–∞—Ü–∏—è –≤—ã—á–∏—Ç–∞–Ω–∏—è
            subtract(other) {
                this.validateOctonion(other);
                const result = new Float64Array(8);
                for (let i = 0; i < 8; i++) {
                    result[i] = this.coefficients[i] - other.coefficients[i];
                }
                return new SecureOctonion(...result);
            }
            
            // –û–ø–µ—Ä–∞—Ü–∏—è —É–º–Ω–æ–∂–µ–Ω–∏—è (–Ω–µ–∞—Å—Å–æ—Ü–∏–∞—Ç–∏–≤–Ω–∞—è)
            multiply(other) {
                this.validateOctonion(other);
                const a = this.coefficients;
                const b = other.coefficients;
                const result = new Float64Array(8);
                
                // –£–º–Ω–æ–∂–µ–Ω–∏–µ –æ–∫—Ç–æ–Ω–∏–æ–Ω–æ–≤ –ø–æ –ø—Ä–∞–≤–∏–ª–∞–º –ö—ç–ª–∏
                result[0] = a[0]*b[0] - a[1]*b[1] - a[2]*b[2] - a[3]*b[3] - a[4]*b[4] - a[5]*b[5] - a[6]*b[6] - a[7]*b[7];
                result[1] = a[0]*b[1] + a[1]*b[0] + a[2]*b[4] + a[3]*b[7] - a[4]*b[2] + a[5]*b[6] - a[6]*b[5] - a[7]*b[3];
                result[2] = a[0]*b[2] - a[1]*b[4] + a[2]*b[0] + a[3]*b[5] + a[4]*b[1] - a[5]*b[3] + a[6]*b[7] - a[7]*b[6];
                result[3] = a[0]*b[3] - a[1]*b[7] - a[2]*b[5] + a[3]*b[0] + a[4]*b[6] + a[5]*b[2] - a[6]*b[4] + a[7]*b[1];
                result[4] = a[0]*b[4] + a[1]*b[2] - a[2]*b[1] - a[3]*b[6] + a[4]*b[0] + a[5]*b[7] + a[6]*b[3] - a[7]*b[5];
                result[5] = a[0]*b[5] - a[1]*b[6] + a[2]*b[3] - a[3]*b[2] - a[4]*b[7] + a[5]*b[0] + a[6]*b[1] + a[7]*b[4];
                result[6] = a[0]*b[6] + a[1]*b[5] - a[2]*b[7] + a[3]*b[4] - a[4]*b[3] - a[5]*b[1] + a[6]*b[0] + a[7]*b[2];
                result[7] = a[0]*b[7] + a[1]*b[3] + a[2]*b[6] - a[3]*b[1] + a[4]*b[5] - a[5]*b[4] - a[6]*b[2] + a[7]*b[0];
                
                return new SecureOctonion(...result);
            }
            
            // –û–±—Ä–∞—Ç–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç
            inverse() {
                const norm = this.norm();
                if (norm < 1e-15) {
                    throw new Error("–ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –≤—ã—á–∏—Å–ª–∏—Ç—å –æ–±—Ä–∞—Ç–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç –¥–ª—è –Ω—É–ª–µ–≤–æ–≥–æ –æ–∫—Ç–æ–Ω–∏–æ–Ω–∞");
                }
                
                const result = new Float64Array(8);
                result[0] = this.coefficients[0] / norm;
                for (let i = 1; i < 8; i++) {
                    result[i] = -this.coefficients[i] / norm;
                }
                
                return new SecureOctonion(...result);
            }
            
            // –ù–æ—Ä–º–∞ –æ–∫—Ç–æ–Ω–∏–æ–Ω–∞
            norm() {
                let sum = 0;
                for (let i = 0; i < 8; i++) {
                    sum += this.coefficients[i] * this.coefficients[i];
                }
                return Math.sqrt(sum);
            }
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏ –¥—Ä—É–≥–æ–≥–æ –æ–∫—Ç–æ–Ω–∏–æ–Ω–∞
            validateOctonion(other) {
                if (!(other instanceof SecureOctonion)) {
                    throw new Error("–û–ø–µ—Ä–∞–Ω–¥ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–º SecureOctonion");
                }
            }
            
            // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω–æ–≥–æ –æ–∫—Ç–æ–Ω–∏–æ–Ω–∞
            static random() {
                const coefficients = new Float64Array(8);
                for (let i = 0; i < 8; i++) {
                    coefficients[i] = SecureOctonion.randomFloat();
                }
                return new SecureOctonion(...coefficients);
            }
            
            // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω–æ–≥–æ –º–∞–ª–æ–≥–æ –æ–∫—Ç–æ–Ω–∏–æ–Ω–∞ (–¥–ª—è –æ—à–∏–±–æ–∫)
            static smallRandom(max = 1) {
                const coefficients = new Float64Array(8);
                for (let i = 0; i < 8; i++) {
                    coefficients[i] = (SecureOctonion.randomFloat() * 2 - 1) * max;
                }
                return new SecureOctonion(...coefficients);
            }
            
            // –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω—ã–π —Å–ª—É—á–∞–π–Ω—ã–π float
            static randomFloat() {
                const buffer = new Uint32Array(1);
                window.crypto.getRandomValues(buffer);
                return buffer[0] / (0xFFFFFFFF + 1);
            }
            
            // –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤ —Å—Ç—Ä–æ–∫—É
            toString(precision = 8) {
                return this.coefficients.map(x => x.toFixed(precision)).join('|');
            }
            
            // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ —Å—Ç—Ä–æ–∫–∏
            static fromString(str) {
                const parts = str.split('|').map(Number);
                if (parts.length !== 8 || parts.some(isNaN)) {
                    throw new Error("–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç —Å—Ç—Ä–æ–∫–∏ –æ–∫—Ç–æ–Ω–∏–æ–Ω–∞");
                }
                return new SecureOctonion(...parts);
            }
            
            // –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤ –±–∞–π—Ç—ã (64 –±–∞–π—Ç–∞)
            toBytes() {
                const buffer = new ArrayBuffer(64);
                const view = new DataView(buffer);
                for (let i = 0; i < 8; i++) {
                    view.setFloat64(i * 8, this.coefficients[i], true);
                }
                return new Uint8Array(buffer);
            }
            
            // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ –±–∞–π—Ç–æ–≤
            static fromBytes(bytes) {
                if (bytes.length !== 64) {
                    throw new Error("–î–ª—è –æ–∫—Ç–æ–Ω–∏–æ–Ω–∞ —Ç—Ä–µ–±—É–µ—Ç—Å—è 64 –±–∞–π—Ç–∞");
                }
                const view = new DataView(bytes.buffer);
                const coefficients = new Float64Array(8);
                for (let i = 0; i < 8; i++) {
                    coefficients[i] = view.getFloat64(i * 8, true);
                }
                return new SecureOctonion(...coefficients);
            }
            
            // –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
            constantTimeEquals(other) {
                this.validateOctonion(other);
                let result = 0;
                for (let i = 0; i < 8; i++) {
                    // –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø–æ–±–∏—Ç–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
                    result |= (this.coefficients[i] ^ other.coefficients[i]);
                }
                return result === 0;
            }
        }
        
        /**
         * –ö–ª–∞—Å—Å –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ KEM –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ–∫—Ç–æ–Ω–∏–æ–Ω–æ–≤
         */
        class OctonionKEM {
            constructor(settings) {
                this.settings = settings;
                this.publicParameters = this.generatePublicParameters();
            }
            
            // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—É–±–ª–∏—á–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (–∞–Ω–∞–ª–æ–≥ –º–∞—Ç—Ä–∏—Ü—ã A –≤ LWE)
            generatePublicParameters() {
                const params = [];
                for (let i = 0; i < 8; i++) {
                    params.push(SecureOctonion.random());
                }
                return params;
            }
            
            // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–µ–≤–æ–π –ø–∞—Ä—ã
            generateKeyPair() {
                try {
                    // –°–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á - –º–∞–ª—ã–π –æ–∫—Ç–æ–Ω–∏–æ–Ω
                    const secretKey = SecureOctonion.smallRandom(this.settings.errorSize);
                    
                    // –ü—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á - A*s + e
                    const publicKey = this.publicParameters[0].multiply(secretKey);
                    let error = SecureOctonion.smallRandom(this.settings.errorSize / 2);
                    
                    for (let i = 1; i < 8; i++) {
                        publicKey.add(this.publicParameters[i].multiply(secretKey));
                        error = error.add(SecureOctonion.smallRandom(this.settings.errorSize / 2));
                    }
                    
                    publicKey.add(error);
                    
                    return {
                        publicKey: publicKey,
                        secretKey: secretKey
                    };
                } catch (e) {
                    throw new Error(`–û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–ª—é—á–µ–π: ${e.message}`);
                }
            }
            
            // –ò–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏—è –∫–ª—é—á–∞
            encapsulate(publicKey) {
                try {
                    // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –≤—Ä–µ–º–µ–Ω–Ω—ã–π —Å–µ–∫—Ä–µ—Ç
                    const tempSecret = SecureOctonion.smallRandom(this.settings.errorSize);
                    
                    // –í—ã—á–∏—Å–ª—è–µ–º –æ–±—â–∏–π —Å–µ–∫—Ä–µ—Ç
                    const sharedSecret = publicKey.multiply(tempSecret);
                    
                    // –í—ã—á–∏—Å–ª—è–µ–º –∏–Ω–∫–∞–ø—Å—É–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–ª—é—á
                    const encapsulated = this.publicParameters[0].multiply(tempSecret);
                    let error = SecureOctonion.smallRandom(this.settings.errorSize / 2);
                    
                    for (let i = 1; i < 8; i++) {
                        encapsulated.add(this.publicParameters[i].multiply(tempSecret));
                        error = error.add(SecureOctonion.smallRandom(this.settings.errorSize / 2));
                    }
                    
                    encapsulated.add(error);
                    
                    // –•–µ—à–∏—Ä—É–µ–º –æ–±—â–∏–π —Å–µ–∫—Ä–µ—Ç –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∫–ª—é—á–∞ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –¥–ª–∏–Ω—ã
                    const hashedSecret = this.hashOctonion(sharedSecret);
                    
                    return {
                        sharedSecret: hashedSecret,
                        encapsulatedKey: encapsulated
                    };
                } catch (e) {
                    throw new Error(`–û—à–∏–±–∫–∞ –∏–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏–∏: ${e.message}`);
                }
            }
            
            // –î–µ–∫–∞–ø—Å—É–ª—è—Ü–∏—è –∫–ª—é—á–∞
            decapsulate(encapsulatedKey, secretKey) {
                try {
                    // –í—ã—á–∏—Å–ª—è–µ–º –æ–±—â–∏–π —Å–µ–∫—Ä–µ—Ç
                    const sharedSecret = encapsulatedKey.multiply(secretKey);
                    
                    // –•–µ—à–∏—Ä—É–µ–º –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∫–ª—é—á–∞ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –¥–ª–∏–Ω—ã
                    return this.hashOctonion(sharedSecret);
                } catch (e) {
                    throw new Error(`–û—à–∏–±–∫–∞ –¥–µ–∫–∞–ø—Å—É–ª—è—Ü–∏–∏: ${e.message}`);
                }
            }
            
            // –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–∫—Ç–æ–Ω–∏–æ–Ω–∞
            hashOctonion(o) {
                const bytes = o.toBytes();
                return this.hashBytes(bytes);
            }
            
            // –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –±–∞–π—Ç–æ–≤
            hashBytes(bytes) {
                // –í —Ä–µ–∞–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ —Å–ª–µ–¥—É–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Web Crypto API –∏–ª–∏ –∞–Ω–∞–ª–æ–≥–∏
                // –ó–¥–µ—Å—å —É–ø—Ä–æ—â—ë–Ω–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏
                const hash = new Uint8Array(32); // 256 –±–∏—Ç
                
                // –ü—Ä–æ—Å—Ç–æ–µ —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ (–≤ —Ä–µ–∞–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å SHA-3)
                for (let i = 0; i < bytes.length; i++) {
                    hash[i % 32] ^= bytes[i];
                }
                
                return hash;
            }
        }
        
        /**
         * –ö–ª–∞—Å—Å –¥–ª—è —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–≥–æ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ–∫—Ç–æ–Ω–∏–æ–Ω–æ–≤
         */
        class OctonionCipher {
            constructor(settings) {
                this.settings = settings;
                this.rounds = settings.rounds;
                this.mode = settings.mode;
            }
            
            // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–∞—É–Ω–¥–æ–≤—ã—Ö –∫–ª—é—á–µ–π
            generateRoundKeys(masterKey) {
                const roundKeys = [];
                let currentKey = masterKey;
                
                for (let i = 0; i < this.rounds + 1; i++) {
                    // –ü—Ä–∏–º–µ–Ω—è–µ–º –Ω–µ–ª–∏–Ω–µ–π–Ω–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –Ω–æ–≤–æ–≥–æ –∫–ª—é—á–∞
                    const newKey = this.nonlinearTransform(currentKey, i);
                    roundKeys.push(newKey);
                    currentKey = newKey;
                }
                
                return roundKeys;
            }
            
            // –ù–µ–ª–∏–Ω–µ–π–Ω–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–ª—é—á–µ–π
            nonlinearTransform(o, round) {
                const r = new Float64Array(8);
                for (let i = 0; i < 8; i++) {
                    // –ö–æ–º–±–∏–Ω–∞—Ü–∏—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –Ω–µ–ª–∏–Ω–µ–π–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
                    r[i] = Math.sin(o.coefficients[i] + round) + 
                            Math.atan(o.coefficients[(i + 1) % 8] * o.coefficients[(i + 3) % 8]) +
                            (o.coefficients[(i + 5) % 8] > 0 ? Math.log(Math.abs(o.coefficients[(i + 5) % 8])) : 0);
                }
                return new SecureOctonion(...r);
            }
            
            // S-–±–æ–∫—Å –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ–∫—Ç–æ–Ω–∏–æ–Ω–Ω–æ–≥–æ —É–º–Ω–æ–∂–µ–Ω–∏—è
            sBox(o) {
                const magic = new SecureOctonion(0.5, 0.3, -0.2, 0.7, -0.4, 0.1, -0.6, 0.8);
                const transformed = o.multiply(magic).multiply(o);
                
                const r = new Float64Array(8);
                for (let i = 0; i < 8; i++) {
                    // –°–∏–≥–º–æ–∏–¥–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –Ω–µ–ª–∏–Ω–µ–π–Ω–æ—Å—Ç–∏
                    r[i] = 1 / (1 + Math.exp(-transformed.coefficients[i]));
                }
                
                return new SecureOctonion(...r);
            }
            
            // –û–±—Ä–∞—Ç–Ω—ã–π S-–±–æ–∫—Å
            inverseSBox(o) {
                const magic = new SecureOctonion(0.5, 0.3, -0.2, 0.7, -0.4, 0.1, -0.6, 0.8).inverse();
                
                const r = new Float64Array(8);
                for (let i = 0; i < 8; i++) {
                    // –û–±—Ä–∞—Ç–Ω–∞—è —Å–∏–≥–º–æ–∏–¥–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è
                    r[i] = Math.log(o.coefficients[i] / (1 - o.coefficients[i]));
                }
                
                const transformed = new SecureOctonion(...r);
                return transformed.multiply(magic).multiply(transformed);
            }
            
            // –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –±–ª–æ–∫–∞
            encryptBlock(block, roundKeys) {
                let state = block;
                
                // –ù–∞—á–∞–ª—å–Ω–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ
                state = state.add(roundKeys[0]);
                
                // –û—Å–Ω–æ–≤–Ω—ã–µ —Ä–∞—É–Ω–¥—ã
                for (let i = 1; i <= this.rounds; i++) {
                    // –ù–µ–ª–∏–Ω–µ–π–Ω–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ
                    state = this.sBox(state);
                    
                    // –£–º–Ω–æ–∂–µ–Ω–∏–µ –Ω–∞ —Ä–∞—É–Ω–¥–æ–≤—ã–π –∫–ª—é—á
                    state = state.multiply(roundKeys[i]);
                    
                    // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã —Ä–∞—É–Ω–¥–∞
                    const roundConstant = new SecureOctonion(i, i+1, i+2, i+3, i+4, i+5, i+6, i+7);
                    state = state.add(roundConstant);
                    
                    // –ü–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤
                    const permuted = new Float64Array(8);
                    for (let j = 0; j < 8; j++) {
                        permuted[j] = state.coefficients[(j + i) % 8];
                    }
                    state = new SecureOctonion(...permuted);
                }
                
                return state;
            }
            
            // –î–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –±–ª–æ–∫–∞
            decryptBlock(block, roundKeys) {
                let state = block;
                
                // –û–±—Ä–∞—Ç–Ω—ã–µ —Ä–∞—É–Ω–¥—ã –≤ –æ–±—Ä–∞—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ
                for (let i = this.rounds; i >= 1; i--) {
                    // –û–±—Ä–∞—Ç–Ω–∞—è –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∞
                    const permuted = new Float64Array(8);
                    for (let j = 0; j < 8; j++) {
                        permuted[(j + i) % 8] = state.coefficients[j];
                    }
                    state = new SecureOctonion(...permuted);
                    
                    // –í—ã—á–∏—Ç–∞–Ω–∏–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã —Ä–∞—É–Ω–¥–∞
                    const roundConstant = new SecureOctonion(i, i+1, i+2, i+3, i+4, i+5, i+6, i+7);
                    state = state.subtract(roundConstant);
                    
                    // –£–º–Ω–æ–∂–µ–Ω–∏–µ –Ω–∞ –æ–±—Ä–∞—Ç–Ω—ã–π —Ä–∞—É–Ω–¥–æ–≤—ã–π –∫–ª—é—á
                    state = state.multiply(roundKeys[i].inverse());
                    
                    // –û–±—Ä–∞—Ç–Ω–æ–µ –Ω–µ–ª–∏–Ω–µ–π–Ω–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ
                    state = this.inverseSBox(state);
                }
                
                // –û–±—Ä–∞—Ç–Ω–æ–µ –Ω–∞—á–∞–ª—å–Ω–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ
                state = state.subtract(roundKeys[0]);
                
                return state;
            }
            
            // –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
            encrypt(data, key) {
                try {
                    // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –∫–ª—é—á –≤ –æ–∫—Ç–æ–Ω–∏–æ–Ω
                    const keyOctonion = this.keyToOctonion(key);
                    
                    // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Ä–∞—É–Ω–¥–æ–≤—ã–µ –∫–ª—é—á–∏
                    const roundKeys = this.generateRoundKeys(keyOctonion);
                    
                    // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –¥–∞–Ω–Ω—ã–µ –≤ –æ–∫—Ç–æ–Ω–∏–æ–Ω—ã
                    const blocks = this.dataToOctonions(data);
                    
                    // –®–∏—Ñ—Ä—É–µ–º –∫–∞–∂–¥—ã–π –±–ª–æ–∫ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å —Ä–µ–∂–∏–º–æ–º
                    let encryptedBlocks;
                    
                    switch (this.mode) {
                        case 'OCB':
                            encryptedBlocks = this.encryptOCB(blocks, roundKeys);
                            break;
                        case 'GCM':
                            encryptedBlocks = this.encryptGCM(blocks, roundKeys);
                            break;
                        case 'CBC':
                            encryptedBlocks = this.encryptCBC(blocks, roundKeys);
                            break;
                        default:
                            throw new Error(`–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ä–µ–∂–∏–º —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è: ${this.mode}`);
                    }
                    
                    // –°–µ—Ä–∏–∞–ª–∏–∑—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
                    return this.octonionsToData(encryptedBlocks);
                } catch (e) {
                    throw new Error(`–û—à–∏–±–∫–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è: ${e.message}`);
                }
            }
            
            // –î–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
            decrypt(data, key) {
                try {
                    // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –∫–ª—é—á –≤ –æ–∫—Ç–æ–Ω–∏–æ–Ω
                    const keyOctonion = this.keyToOctonion(key);
                    
                    // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Ä–∞—É–Ω–¥–æ–≤—ã–µ –∫–ª—é—á–∏
                    const roundKeys = this.generateRoundKeys(keyOctonion);
                    
                    // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –¥–∞–Ω–Ω—ã–µ –≤ –æ–∫—Ç–æ–Ω–∏–æ–Ω—ã
                    const blocks = this.dataToOctonions(data);
                    
                    // –î–µ—à–∏—Ñ—Ä—É–µ–º –±–ª–æ–∫–∏ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å —Ä–µ–∂–∏–º–æ–º
                    let decryptedBlocks;
                    
                    switch (this.mode) {
                        case 'OCB':
                            decryptedBlocks = this.decryptOCB(blocks, roundKeys);
                            break;
                        case 'GCM':
                            decryptedBlocks = this.decryptGCM(blocks, roundKeys);
                            break;
                        case 'CBC':
                            decryptedBlocks = this.decryptCBC(blocks, roundKeys);
                            break;
                        default:
                            throw new Error(`–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ä–µ–∂–∏–º —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è: ${this.mode}`);
                    }
                    
                    // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –æ–∫—Ç–æ–Ω–∏–æ–Ω—ã –æ–±—Ä–∞—Ç–Ω–æ –≤ –¥–∞–Ω–Ω—ã–µ
                    return this.octonionsToData(decryptedBlocks, true);
                } catch (e) {
                    throw new Error(`–û—à–∏–±–∫–∞ –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è: ${e.message}`);
                }
            }
            
            // –†–µ–∂–∏–º OCB (Offset Codebook)
            encryptOCB(blocks, roundKeys) {
                const encryptedBlocks = [];
                const nonce = SecureOctonion.random();
                let prevBlock = nonce;
                
                for (let i = 0; i < blocks.length; i++) {
                    // OCB: XOR —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–º –±–ª–æ–∫–æ–º –ø–µ—Ä–µ–¥ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ–º
                    const blockToEncrypt = blocks[i].add(prevBlock);
                    const encryptedBlock = this.encryptBlock(blockToEncrypt, roundKeys);
                    
                    // OCB: XOR —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º –±–ª–æ–∫–æ–º
                    const finalBlock = encryptedBlock.add(prevBlock);
                    encryptedBlocks.push(finalBlock);
                    
                    prevBlock = encryptedBlock;
                }
                
                // –î–æ–±–∞–≤–ª—è–µ–º nonce –≤ –Ω–∞—á–∞–ª–æ
                encryptedBlocks.unshift(nonce);
                
                return encryptedBlocks;
            }
            
            // –î–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ OCB
            decryptOCB(blocks, roundKeys) {
                const decryptedBlocks = [];
                const nonce = blocks.shift();
                let prevBlock = nonce;
                
                for (let i = 0; i < blocks.length; i++) {
                    // OCB: XOR —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º –±–ª–æ–∫–æ–º –ø–µ—Ä–µ–¥ –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ–º
                    const blockToDecrypt = blocks[i].subtract(prevBlock);
                    const decryptedBlock = this.decryptBlock(blockToDecrypt, roundKeys);
                    
                    // OCB: XOR —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–º –±–ª–æ–∫–æ–º
                    const finalBlock = decryptedBlock.subtract(prevBlock);
                    decryptedBlocks.push(finalBlock);
                    
                    prevBlock = blocks[i];
                }
                
                return decryptedBlocks;
            }
            
            // –†–µ–∂–∏–º GCM (Galois/Counter Mode)
            encryptGCM(blocks, roundKeys) {
                // –†–µ–∞–ª–∏–∑–∞—Ü–∏—è GCM —Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ (GHASH, —Å—á–µ—Ç—á–∏–∫)
                // –ó–¥–µ—Å—å —É–ø—Ä–æ—â—ë–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏
                const encryptedBlocks = [];
                const iv = SecureOctonion.random();
                let counter = 0;
                
                encryptedBlocks.push(iv);
                
                for (let i = 0; i < blocks.length; i++) {
                    const counterOctonion = iv.add(new SecureOctonion(counter, counter, counter, counter, counter, counter, counter, counter));
                    const encryptedCounter = this.encryptBlock(counterOctonion, roundKeys);
                    
                    const encryptedBlock = blocks[i].add(encryptedCounter);
                    encryptedBlocks.push(encryptedBlock);
                    
                    counter++;
                }
                
                return encryptedBlocks;
            }
            
            // –î–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ GCM
            decryptGCM(blocks, roundKeys) {
                const decryptedBlocks = [];
                const iv = blocks.shift();
                let counter = 0;
                
                for (let i = 0; i < blocks.length; i++) {
                    const counterOctonion = iv.add(new SecureOctonion(counter, counter, counter, counter, counter, counter, counter, counter));
                    const encryptedCounter = this.encryptBlock(counterOctonion, roundKeys);
                    
                    const decryptedBlock = blocks[i].subtract(encryptedCounter);
                    decryptedBlocks.push(decryptedBlock);
                    
                    counter++;
                }
                
                return decryptedBlocks;
            }
            
            // –†–µ–∂–∏–º CBC (Cipher Block Chaining)
            encryptCBC(blocks, roundKeys) {
                const encryptedBlocks = [];
                const iv = SecureOctonion.random();
                let prevBlock = iv;
                
                encryptedBlocks.push(iv);
                
                for (let i = 0; i < blocks.length; i++) {
                    const blockToEncrypt = blocks[i].add(prevBlock);
                    const encryptedBlock = this.encryptBlock(blockToEncrypt, roundKeys);
                    encryptedBlocks.push(encryptedBlock);
                    prevBlock = encryptedBlock;
                }
                
                return encryptedBlocks;
            }
            
            // –î–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ CBC
            decryptCBC(blocks, roundKeys) {
                const decryptedBlocks = [];
                const iv = blocks.shift();
                let prevBlock = iv;
                
                for (let i = 0; i < blocks.length; i++) {
                    const decryptedBlock = this.decryptBlock(blocks[i], roundKeys);
                    const finalBlock = decryptedBlock.subtract(prevBlock);
                    decryptedBlocks.push(finalBlock);
                    prevBlock = blocks[i];
                }
                
                return decryptedBlocks;
            }
            
            // –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ –æ–∫—Ç–æ–Ω–∏–æ–Ω—ã
            dataToOctonions(data) {
                // –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ - —Å—Ç—Ä–æ–∫–∞, –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤ –±–∞–π—Ç—ã
                if (typeof data === 'string') {
                    data = new TextEncoder().encode(data);
                }
                
                // –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ - Uint8Array, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∫–∞–∫ –±–∞–π—Ç—ã
                if (data instanceof Uint8Array) {
                    const blocks = [];
                    const blockSize = 32; // 32 –±–∞–π—Ç–∞ –Ω–∞ –±–ª–æ–∫ (4 double)
                    
                    for (let i = 0; i < data.length; i += blockSize) {
                        const block = new Uint8Array(blockSize);
                        for (let j = 0; j < blockSize && i + j < data.length; j++) {
                            block[j] = data[i + j];
                        }
                        
                        // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º 32 –±–∞–π—Ç–∞ –≤ 4 double (64 –±–∏—Ç–∞ –∫–∞–∂–¥–æ–µ)
                        const view = new DataView(block.buffer);
                        const e0 = view.getFloat64(0, true);
                        const e1 = view.getFloat64(8, true);
                        const e2 = view.getFloat64(16, true);
                        const e3 = view.getFloat64(24, true);
                        
                        blocks.push(new SecureOctonion(e0, e1, e2, e3, 0, 0, 0, 0));
                    }
                    
                    return blocks;
                }
                
                throw new Error("–ù–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö");
            }
            
            // –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –æ–∫—Ç–æ–Ω–∏–æ–Ω–æ–≤ –≤ –¥–∞–Ω–Ω—ã–µ
            octonionsToData(octonions, isText = false) {
                const buffers = [];
                let totalLength = 0;
                
                for (const o of octonions) {
                    const bytes = o.toBytes();
                    buffers.push(bytes);
                    totalLength += bytes.length;
                }
                
                // –û–±—ä–µ–¥–∏–Ω—è–µ–º –≤—Å–µ –±—É—Ñ–µ—Ä—ã
                const result = new Uint8Array(totalLength);
                let offset = 0;
                
                for (const buf of buffers) {
                    result.set(buf, offset);
                    offset += buf.length;
                }
                
                // –ï—Å–ª–∏ –æ–∂–∏–¥–∞–µ–º —Ç–µ–∫—Å—Ç, –¥–µ–∫–æ–¥–∏—Ä—É–µ–º
                if (isText) {
                    // –£–¥–∞–ª—è–µ–º –Ω—É–ª–µ–≤—ã–µ –±–∞–π—Ç—ã –≤ –∫–æ–Ω—Ü–µ
                    let end = result.length;
                    while (end > 0 && result[end - 1] === 0) end--;
                    
                    return new TextDecoder().decode(result.subarray(0, end));
                }
                
                return result;
            }
            
            // –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∫–ª—é—á–∞ –≤ –æ–∫—Ç–æ–Ω–∏–æ–Ω
            keyToOctonion(key) {
                if (typeof key === 'string') {
                    // –ï—Å–ª–∏ –∫–ª—é—á - hex-—Å—Ç—Ä–æ–∫–∞
                    if (/^[0-9a-f]+$/i.test(key)) {
                        const bytes = new Uint8Array(key.length / 2);
                        for (let i = 0; i < bytes.length; i++) {
                            bytes[i] = parseInt(key.substr(i * 2, 2), 16);
                        }
                        return SecureOctonion.fromBytes(bytes);
                    }
                    
                    // –ï—Å–ª–∏ –∫–ª—é—á - —Å—Ç—Ä–æ–∫–∞ –æ–∫—Ç–æ–Ω–∏–æ–Ω–∞
                    if (key.includes('|')) {
                        return SecureOctonion.fromString(key);
                    }
                    
                    // –ò–Ω–∞—á–µ —Å—á–∏—Ç–∞–µ–º —Ç–µ–∫—Å—Ç–æ–≤—ã–º –∫–ª—é—á–æ–º
                    const encoder = new TextEncoder();
                    const bytes = encoder.encode(key);
                    return SecureOctonion.fromBytes(bytes);
                }
                
                if (key instanceof Uint8Array) {
                    return SecureOctonion.fromBytes(key);
                }
                
                throw new Error("–ù–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π —Ñ–æ—Ä–º–∞—Ç –∫–ª—é—á–∞");
            }
        }
        
        // =============================================
        // –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò
        // =============================================
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã
        function initSystem() {
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
            loadSettings();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
            updateUI();
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –∫—Ä–∏–ø—Ç–æ—Å–∏—Å—Ç–µ–º—É
            systemState.kem = new OctonionKEM(systemState.settings);
            systemState.cipher = new OctonionCipher(systemState.settings);
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ –∫–ª—é—á–∏
            const savedKeys = localStorage.getItem('octoKEMKeys');
            if (savedKeys) {
                try {
                    systemState.currentKeyPair = JSON.parse(savedKeys);
                    document.getElementById('publicKey').value = systemState.currentKeyPair.publicKey;
                    document.getElementById('privateKey').value = systemState.currentKeyPair.secretKey;
                    showAlert('–ó–∞–≥—Ä—É–∂–µ–Ω—ã —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ –∫–ª—é—á–∏', 'success');
                    visualizeKey(systemState.currentKeyPair.publicKey);
                } catch (e) {
                    console.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–ª—é—á–µ–π:", e);
                    showAlert('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö –∫–ª—é—á–µ–π', 'error');
                }
            }
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º —Ñ–æ–Ω–æ–≤—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏
            checkSystemRequirements();
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫
        function loadSettings() {
            const savedSettings = localStorage.getItem('octoKEMSettings');
            if (savedSettings) {
                try {
                    systemState.settings = {...DEFAULT_SETTINGS, ...JSON.parse(savedSettings)};
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã UI
                    document.getElementById('rounds').value = systemState.settings.rounds;
                    document.getElementById('errorSize').value = systemState.settings.errorSize;
                    document.getElementById('keySize').value = systemState.settings.keySize;
                    document.getElementById('mode').value = systemState.settings.mode;
                    document.getElementById('keyDerivation').value = systemState.settings.keyDerivation;
                    document.getElementById('hashAlgorithm').value = systemState.settings.hashAlgorithm;
                    document.getElementById('keyExpiration').value = systemState.settings.keyExpiration;
                    document.getElementById('maxKeyUsage').value = systemState.settings.maxKeyUsage;
                    document.getElementById('keyWipePolicy').value = systemState.settings.keyWipePolicy;
                    document.getElementById('entropySource').value = systemState.settings.entropySource;
                    
                    showAlert('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã', 'success');
                } catch (e) {
                    console.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫:", e);
                    systemState.settings = {...DEFAULT_SETTINGS};
                    showAlert('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫. –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ.', 'warning');
                }
            } else {
                systemState.settings = {...DEFAULT_SETTINGS};
            }
        }
        
        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫
        function saveSettings() {
            systemState.settings = {
                rounds: parseInt(document.getElementById('rounds').value),
                errorSize: parseInt(document.getElementById('errorSize').value),
                keySize: parseInt(document.getElementById('keySize').value),
                mode: document.getElementById('mode').value,
                keyDerivation: document.getElementById('keyDerivation').value,
                hashAlgorithm: document.getElementById('hashAlgorithm').value,
                keyExpiration: parseInt(document.getElementById('keyExpiration').value),
                maxKeyUsage: parseInt(document.getElementById('maxKeyUsage').value),
                keyWipePolicy: document.getElementById('keyWipePolicy').value,
                entropySource: document.getElementById('entropySource').value
            };
            
            localStorage.setItem('octoKEMSettings', JSON.stringify(systemState.settings));
            
            // –ü–µ—Ä–µ–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Å–∏—Å—Ç–µ–º—É —Å –Ω–æ–≤—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
            systemState.kem = new OctonionKEM(systemState.settings);
            systemState.cipher = new OctonionCipher(systemState.settings);
            
            showAlert('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã', 'success');
            updateSecurityLevel();
        }
        
        // –°–±—Ä–æ—Å –Ω–∞—Å—Ç—Ä–æ–µ–∫
        function resetSettings() {
            systemState.settings = {...DEFAULT_SETTINGS};
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã UI
            document.getElementById('rounds').value = systemState.settings.rounds;
            document.getElementById('errorSize').value = systemState.settings.errorSize;
            document.getElementById('keySize').value = systemState.settings.keySize;
            document.getElementById('mode').value = systemState.settings.mode;
            document.getElementById('keyDerivation').value = systemState.settings.keyDerivation;
            document.getElementById('hashAlgorithm').value = systemState.settings.hashAlgorithm;
            document.getElementById('keyExpiration').value = systemState.settings.keyExpiration;
            document.getElementById('maxKeyUsage').value = systemState.settings.maxKeyUsage;
            document.getElementById('keyWipePolicy').value = systemState.settings.keyWipePolicy;
            document.getElementById('entropySource').value = systemState.settings.entropySource;
            
            localStorage.removeItem('octoKEMSettings');
            
            // –ü–µ—Ä–µ–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Å–∏—Å—Ç–µ–º—É
            systemState.kem = new OctonionKEM(systemState.settings);
            systemState.cipher = new OctonionCipher(systemState.settings);
            
            showAlert('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–±—Ä–æ—à–µ–Ω—ã –∫ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º', 'success');
            updateSecurityLevel();
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —É—Ä–æ–≤–Ω—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
        function updateSecurityLevel() {
            let level, text;
            
            if (systemState.settings.keySize >= 512 && systemState.settings.rounds >= 20) {
                level = 'paranoid';
                text = '–ü–∞—Ä–∞–Ω–æ–∏–¥–∞–ª—å–Ω—ã–π (512-–±–∏—Ç)';
            } else if (systemState.settings.keySize >= 384 && systemState.settings.rounds >= 16) {
                level = 'ultra';
                text = '–£–ª—å—Ç—Ä–∞ –≤—ã—Å–æ–∫–∏–π (384-–±–∏—Ç)';
            } else if (systemState.settings.keySize >= 256 && systemState.settings.rounds >= 12) {
                level = 'high';
                text = '–í—ã—Å–æ–∫–∏–π (256-–±–∏—Ç)';
            } else if (systemState.settings.keySize >= 192 && systemState.settings.rounds >= 8) {
                level = 'medium';
                text = '–°—Ä–µ–¥–Ω–∏–π (192-–±–∏—Ç)';
            } else {
                level = 'low';
                text = '–ù–∏–∑–∫–∏–π (128-–±–∏—Ç)';
            }
            
            systemState.securityLevel = level;
            document.getElementById('securityLevel').textContent = `–£—Ä–æ–≤–µ–Ω—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏: ${text}`;
        }
        
        // –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∫–ª—é—á–∞
        function visualizeKey(keyStr) {
            const container = document.getElementById('keyVisualization');
            container.innerHTML = '';
            
            if (!keyStr) return;
            
            // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –∫–ª—é—á –≤ –±–∞–π—Ç—ã
            const key = SecureOctonion.fromString(keyStr);
            const bytes = key.toBytes();
            
            // –°–æ–∑–¥–∞—ë–º –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é
            for (let i = 0; i < bytes.length; i++) {
                const bit = document.createElement('div');
                bit.className = 'key-bit';
                bit.style.opacity = bytes[i] / 255 * 0.8 + 0.2;
                bit.style.backgroundColor = `rgb(${bytes[i]}, ${(bytes[i] + 85) % 256}, ${(bytes[i] + 170) % 256})`;
                bit.title = `–ë–∞–π—Ç ${i}: ${bytes[i]}`;
                container.appendChild(bit);
            }
        }
        
        // =============================================
        // –û–°–ù–û–í–ù–´–ï –§–£–ù–ö–¶–ò–ò –ò–ù–¢–ï–†–§–ï–ô–°–ê
        // =============================================
        
        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–µ–≤–æ–π –ø–∞—Ä—ã
        function generateEnhancedKeyPair() {
            try {
                const startTime = performance.now();
                const keyPair = systemState.kem.generateKeyPair();
                const generationTime = performance.now() - startTime;
                
                systemState.currentKeyPair = {
                    publicKey: keyPair.publicKey.toString(),
                    secretKey: keyPair.secretKey.toString()
                };
                
                document.getElementById('publicKey').value = systemState.currentKeyPair.publicKey;
                document.getElementById('privateKey').value = systemState.currentKeyPair.secretKey;
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∫–ª—é—á–∏
                localStorage.setItem('octoKEMKeys', JSON.stringify(systemState.currentKeyPair));
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –º–µ—Ç—Ä–∏–∫–∏
                systemState.performanceMetrics.kemGeneration = generationTime;
                document.getElementById('kemGenTime').textContent = `${generationTime.toFixed(2)} –º—Å`;
                
                // –í–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–µ–º –∫–ª—é—á
                visualizeKey(systemState.currentKeyPair.publicKey);
                
                showAlert('–ö–ª—é—á–µ–≤–∞—è –ø–∞—Ä–∞ —É—Å–ø–µ—à–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–∞', 'success');
            } catch (e) {
                showAlert(`–û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–ª—é—á–µ–π: ${e.message}`, 'error');
                console.error(e);
            }
        }
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–ª—é—á–µ–≤–æ–π –ø–∞—Ä—ã
        function validateKeyPair() {
            if (!systemState.currentKeyPair) {
                showAlert('–°–Ω–∞—á–∞–ª–∞ —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ –∫–ª—é—á–µ–≤—É—é –ø–∞—Ä—É', 'warning');
                return;
            }
            
            try {
                const publicKey = SecureOctonion.fromString(systemState.currentKeyPair.publicKey);
                const secretKey = SecureOctonion.fromString(systemState.currentKeyPair.secretKey);
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –ø—É–±–ª–∏—á–Ω–æ–≥–æ –∏ –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–µ–π
                const calculatedPublicKey = systemState.kem.publicParameters[0].multiply(secretKey);
                let error = SecureOctonion.smallRandom(systemState.settings.errorSize / 2);
                
                for (let i = 1; i < 8; i++) {
                    calculatedPublicKey.add(systemState.kem.publicParameters[i].multiply(secretKey));
                    error = error.add(SecureOctonion.smallRandom(systemState.settings.errorSize / 2));
                }
                
                calculatedPublicKey.add(error);
                
                // –°—Ä–∞–≤–Ω–∏–≤–∞–µ–º —Å —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–º –ø—É–±–ª–∏—á–Ω—ã–º –∫–ª—é—á–æ–º
                if (publicKey.constantTimeEquals(calculatedPublicKey)) {
                    showAlert('–ö–ª—é—á–µ–≤–∞—è –ø–∞—Ä–∞ –≤–∞–ª–∏–¥–Ω–∞ –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –¥—Ä—É–≥ –¥—Ä—É–≥—É', 'success');
                } else {
                    showAlert('–û–±–Ω–∞—Ä—É–∂–µ–Ω–æ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –∫–ª—é—á–µ–≤–æ–π –ø–∞—Ä—ã!', 'error');
                }
            } catch (e) {
                showAlert(`–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–ª—é—á–µ–π: ${e.message}`, 'error');
                console.error(e);
            }
        }
        
        // –≠–∫—Å–ø–æ—Ä—Ç –∫–ª—é—á–µ–≤–æ–π –ø–∞—Ä—ã
        function exportKeyPair() {
            if (!systemState.currentKeyPair) {
                showAlert('–ù–µ—Ç –∫–ª—é—á–µ–≤–æ–π –ø–∞—Ä—ã –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞', 'warning');
                return;
            }
            
            try {
                const blob = new Blob([JSON.stringify(systemState.currentKeyPair, null, 2)], {type: 'application/json'});
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `octokem_keys_${new Date().toISOString().slice(0, 10)}.json`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                showAlert('–ö–ª—é—á–µ–≤–∞—è –ø–∞—Ä–∞ —É—Å–ø–µ—à–Ω–æ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–∞', 'success');
            } catch (e) {
                showAlert(`–û—à–∏–±–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞ –∫–ª—é—á–µ–π: ${e.message}`, 'error');
                console.error(e);
            }
        }
        
        // –£–Ω–∏—á—Ç–æ–∂–µ–Ω–∏–µ –∫–ª—é—á–µ–≤–æ–π –ø–∞—Ä—ã
        function wipeKeyPair() {
            if (!systemState.currentKeyPair) {
                showAlert('–ù–µ—Ç –∫–ª—é—á–µ–≤–æ–π –ø–∞—Ä—ã –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è', 'warning');
                return;
            }
            
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–Ω–∏—á—Ç–æ–∂–∏—Ç—å —Ç–µ–∫—É—â—É—é –∫–ª—é—á–µ–≤—É—é –ø–∞—Ä—É? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.')) {
                systemState.currentKeyPair = null;
                document.getElementById('publicKey').value = '';
                document.getElementById('privateKey').value = '';
                localStorage.removeItem('octoKEMKeys');
                document.getElementById('keyVisualization').innerHTML = '';
                
                showAlert('–ö–ª—é—á–µ–≤–∞—è –ø–∞—Ä–∞ —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω–∞', 'success');
            }
        }
        
        // –ò–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏—è –∫–ª—é—á–∞
        function encapsulateKey() {
            if (!systemState.currentKeyPair) {
                showAlert('–°–Ω–∞—á–∞–ª–∞ —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ –∫–ª—é—á–µ–≤—É—é –ø–∞—Ä—É', 'warning');
                return;
            }
            
            const recipientPublicKeyStr = document.getElementById('recipientPublicKey').value.trim();
            if (!recipientPublicKeyStr) {
                showAlert('–í–≤–µ–¥–∏—Ç–µ –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á –ø–æ–ª—É—á–∞—Ç–µ–ª—è', 'warning');
                return;
            }
            
            try {
                const startTime = performance.now();
                const recipientPublicKey = SecureOctonion.fromString(recipientPublicKeyStr);
                const result = systemState.kem.encapsulate(recipientPublicKey);
                const encapsulationTime = performance.now() - startTime;
                
                document.getElementById('sharedSecret').value = bytesToHex(result.sharedSecret);
                document.getElementById('encapsulatedKey').value = result.encapsulatedKey.toString();
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –º–µ—Ç—Ä–∏–∫–∏
                systemState.performanceMetrics.kemEncapsulation = encapsulationTime;
                document.getElementById('kemEncTime').textContent = `${encapsulationTime.toFixed(2)} –º—Å`;
                
                showAlert('–ö–ª—é—á —É—Å–ø–µ—à–Ω–æ –∏–Ω–∫–∞–ø—Å—É–ª–∏—Ä–æ–≤–∞–Ω', 'success');
            } catch (e) {
                showAlert(`–û—à–∏–±–∫–∞ –∏–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏–∏: ${e.message}`, 'error');
                console.error(e);
            }
        }
        
        // –ò–º–ø–æ—Ä—Ç –ø—É–±–ª–∏—á–Ω–æ–≥–æ –∫–ª—é—á–∞
        function importPublicKey() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json,.txt';
            
            input.onchange = e => {
                const file = e.target.files[0];
                if (!file) return;
                
                const reader = new FileReader();
                reader.onload = event => {
                    try {
                        const content = event.target.result;
                        let publicKey;
                        
                        // –ü—Ä–æ–±—É–µ–º —Ä–∞–∑–æ–±—Ä–∞—Ç—å –∫–∞–∫ JSON
                        try {
                            const keyPair = JSON.parse(content);
                            publicKey = keyPair.publicKey;
                        } catch {
                            // –ï—Å–ª–∏ –Ω–µ JSON, –ø—Ä–æ–±—É–µ–º –∫–∞–∫ plain text
                            publicKey = content.trim();
                        }
                        
                        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —ç—Ç–æ –ø–æ—Ö–æ–∂–µ –Ω–∞ –∫–ª—é—á
                        if (publicKey && publicKey.includes('|') && publicKey.split('|').length === 8) {
                            document.getElementById('recipientPublicKey').value = publicKey;
                            showAlert('–ü—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á —É—Å–ø–µ—à–Ω–æ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω', 'success');
                        } else {
                            showAlert('–§–∞–π–ª –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –≤–∞–ª–∏–¥–Ω—ã–π –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á', 'error');
                        }
                    } catch (e) {
                        showAlert(`–û—à–∏–±–∫–∞ –∏–º–ø–æ—Ä—Ç–∞ –∫–ª—é—á–∞: ${e.message}`, 'error');
                        console.error(e);
                    }
                };
                reader.readAsText(file);
            };
            
            input.click();
        }
        
        // –î–µ–∫–∞–ø—Å—É–ª—è—Ü–∏—è –∫–ª—é—á–∞
        function decapsulateKey() {
            if (!systemState.currentKeyPair) {
                showAlert('–°–Ω–∞—á–∞–ª–∞ —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ –∫–ª—é—á–µ–≤—É—é –ø–∞—Ä—É', 'warning');
                return;
            }
            
            const encapsulatedKeyStr = document.getElementById('receivedEncapsulatedKey').value.trim();
            if (!encapsulatedKeyStr) {
                showAlert('–í–≤–µ–¥–∏—Ç–µ –∏–Ω–∫–∞–ø—Å—É–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–ª—é—á', 'warning');
                return;
            }
            
            try {
                const startTime = performance.now();
                const encapsulatedKey = SecureOctonion.fromString(encapsulatedKeyStr);
                const secretKey = SecureOctonion.fromString(systemState.currentKeyPair.secretKey);
                
                const sharedSecret = systemState.kem.decapsulate(encapsulatedKey, secretKey);
                const decapsulationTime = performance.now() - startTime;
                
                document.getElementById('decapsulatedSecret').value = bytesToHex(sharedSecret);
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –º–µ—Ç—Ä–∏–∫–∏
                systemState.performanceMetrics.kemDecapsulation = decapsulationTime;
                document.getElementById('kemDecTime').textContent = `${decapsulationTime.toFixed(2)} –º—Å`;
                
                showAlert('–ö–ª—é—á —É—Å–ø–µ—à–Ω–æ –¥–µ–∫–∞–ø—Å—É–ª–∏—Ä–æ–≤–∞–Ω', 'success');
            } catch (e) {
                showAlert(`–û—à–∏–±–∫–∞ –¥–µ–∫–∞–ø—Å—É–ª—è—Ü–∏–∏: ${e.message}`, 'error');
                console.error(e);
            }
        }
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –∫–ª—é—á–µ–π
        function verifyKeyMatch() {
            const sharedSecret1 = document.getElementById('sharedSecret').value.trim();
            const sharedSecret2 = document.getElementById('decapsulatedSecret').value.trim();
            
            if (!sharedSecret1 || !sharedSecret2) {
                showAlert('–°–Ω–∞—á–∞–ª–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –∏–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏—é –∏ –¥–µ–∫–∞–ø—Å—É–ª—è—Ü–∏—é –∫–ª—é—á–∞', 'warning');
                return;
            }
            
            if (sharedSecret1 === sharedSecret2) {
                showAlert('–ö–ª—é—á–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–≤–ø–∞–¥–∞—é—Ç!', 'success');
            } else {
                showAlert('–ö–ª—é—á–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç!', 'error');
            }
        }
        
        // –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
        function encryptData() {
            const plaintext = document.getElementById('plaintext').value;
            if (!plaintext) {
                showAlert('–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è', 'warning');
                return;
            }
            
            const key = document.getElementById('encryptionKey').value.trim();
            if (!key) {
                showAlert('–í–≤–µ–¥–∏—Ç–µ –∫–ª—é—á —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è', 'warning');
                return;
            }
            
            try {
                const startTime = performance.now();
                const ciphertext = systemState.cipher.encrypt(plaintext, key);
                const encryptionTime = performance.now() - startTime;
                
                document.getElementById('ciphertext').value = arrayBufferToBase64(ciphertext);
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –º–µ—Ç—Ä–∏–∫–∏
                systemState.performanceMetrics.encryption = encryptionTime;
                document.getElementById('encryptTime').textContent = `${encryptionTime.toFixed(2)} –º—Å`;
                document.getElementById('throughput').textContent = `${(plaintext.length / encryptionTime * 1000 / 1024).toFixed(2)} KB/s`;
                
                showAlert('–î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ã', 'success');
            } catch (e) {
                showAlert(`–û—à–∏–±–∫–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è: ${e.message}`, 'error');
                console.error(e);
            }
        }
        
        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω–æ–≥–æ –∫–ª—é—á–∞
        function generateRandomKey() {
            try {
                const randomOctonion = SecureOctonion.random();
                document.getElementById('encryptionKey').value = randomOctonion.toString();
                showAlert('–°–ª—É—á–∞–π–Ω—ã–π –∫–ª—é—á —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω', 'success');
            } catch (e) {
                showAlert(`–û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–ª—é—á–∞: ${e.message}`, 'error');
                console.error(e);
            }
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞ –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
        function loadFileForEncryption() {
            const input = document.createElement('input');
            input.type = 'file';
            
            input.onchange = e => {
                const file = e.target.files[0];
                if (!file) return;
                
                const reader = new FileReader();
                reader.onload = event => {
                    document.getElementById('plaintext').value = event.target.result;
                    showAlert(`–§–∞–π–ª "${file.name}" –∑–∞–≥—Ä—É–∂–µ–Ω –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è`, 'success');
                };
                reader.readAsText(file);
            };
            
            input.click();
        }
        
        // –î–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
        function decryptData() {
            const ciphertext = document.getElementById('encryptedData').value.trim();
            if (!ciphertext) {
                showAlert('–í–≤–µ–¥–∏—Ç–µ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ', 'warning');
                return;
            }
            
            const key = document.getElementById('decryptionKey').value.trim();
            if (!key) {
                showAlert('–í–≤–µ–¥–∏—Ç–µ –∫–ª—é—á –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è', 'warning');
                return;
            }
            
            try {
                const startTime = performance.now();
                const data = base64ToArrayBuffer(ciphertext);
                const plaintext = systemState.cipher.decrypt(data, key);
                const decryptionTime = performance.now() - startTime;
                
                document.getElementById('decryptedText').value = plaintext;
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –º–µ—Ç—Ä–∏–∫–∏
                systemState.performanceMetrics.decryption = decryptionTime;
                document.getElementById('decryptTime').textContent = `${decryptionTime.toFixed(2)} –º—Å`;
                
                showAlert('–î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω—ã', 'success');
            } catch (e) {
                showAlert(`–û—à–∏–±–∫–∞ –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è: ${e.message}`, 'error');
                console.error(e);
            }
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞ –¥–ª—è –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
        function loadFileForDecryption() {
            const input = document.createElement('input');
            input.type = 'file';
            
            input.onchange = e => {
                const file = e.target.files[0];
                if (!file) return;
                
                const reader = new FileReader();
                reader.onload = event => {
                    document.getElementById('encryptedData').value = event.target.result;
                    showAlert(`–§–∞–π–ª "${file.name}" –∑–∞–≥—Ä—É–∂–µ–Ω –¥–ª—è –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è`, 'success');
                };
                reader.readAsText(file);
            };
            
            input.click();
        }
        
        // –û—á–∏—Å—Ç–∫–∞ –ø–æ–ª–µ–π –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
        function clearDecryptionFields() {
            document.getElementById('encryptedData').value = '';
            document.getElementById('decryptionKey').value = '';
            document.getElementById('decryptedText').value = '';
            showAlert('–ü–æ–ª—è –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –æ—á–∏—â–µ–Ω—ã', 'success');
        }
        
        // –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø–æ–ª–∏—Ç–∏–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
        function applySecurityPolicy() {
            saveSettings();
            showAlert('–ü–æ–ª–∏—Ç–∏–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∞', 'success');
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
        function showSecurityRecommendations() {
            const recommendations = [
                "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–ª—é—á–∏ —Ä–∞–∑–º–µ—Ä–æ–º –Ω–µ –º–µ–Ω–µ–µ 256 –±–∏—Ç –¥–ª—è –≤–∞–∂–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö",
                "–†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ –∫–ª—é—á–µ–≤—ã–µ –ø–∞—Ä—ã (—Ä–∞–∑ –≤ –Ω–µ–¥–µ–ª—é –∏–ª–∏ –º–µ—Å—è—Ü)",
                "–ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –∫–ª—é—á –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ü–µ–ª–µ–π",
                "–•—Ä–∞–Ω–∏—Ç–µ –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ –∫–ª—é—á–∏ –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–º –º–µ—Å—Ç–µ",
                "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–µ–∂–∏–º OCB –∏–ª–∏ GCM –¥–ª—è –ª—É—á—à–µ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏",
                "–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–ª—é—á–µ–π"
            ];
            
            alert("–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:\n\n- " + recommendations.join("\n- "));
        }
        
        // –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
        function runPerformanceTest() {
            const container = document.getElementById('performanceTestContainer');
            const progress = document.getElementById('performanceProgress');
            const status = document.getElementById('performanceStatus');
            
            container.style.display = 'block';
            progress.value = 0;
            status.textContent = "–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é...";
            
            // –¢–µ—Å—Ç–∏—Ä—É–µ–º –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –∫–ª—é—á–µ–π
            setTimeout(() => {
                progress.value = 10;
                status.textContent = "–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–ª—é—á–µ–π...";
                
                const startGen = performance.now();
                generateEnhancedKeyPair();
                const timeGen = performance.now() - startGen;
                
                progress.value = 30;
                status.textContent = `–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–µ–π: ${timeGen.toFixed(2)} –º—Å`;
                
                // –¢–µ—Å—Ç–∏—Ä—É–µ–º –∏–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏—é
                setTimeout(() => {
                    const recipientKey = SecureOctonion.random().toString();
                    document.getElementById('recipientPublicKey').value = recipientKey;
                    
                    const startEnc = performance.now();
                    encapsulateKey();
                    const timeEnc = performance.now() - startEnc;
                    
                    progress.value = 50;
                    status.textContent += ` | –ò–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏—è: ${timeEnc.toFixed(2)} –º—Å`;
                    
                    // –¢–µ—Å—Ç–∏—Ä—É–µ–º –¥–µ–∫–∞–ø—Å—É–ª—è—Ü–∏—é
                    setTimeout(() => {
                        const startDec = performance.now();
                        decapsulateKey();
                        const timeDec = performance.now() - startDec;
                        
                        progress.value = 70;
                        status.textContent += ` | –î–µ–∫–∞–ø—Å—É–ª—è—Ü–∏—è: ${timeDec.toFixed(2)} –º—Å`;
                        
                        // –¢–µ—Å—Ç–∏—Ä—É–µ–º —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ
                        setTimeout(() => {
                            const testData = "–¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã. ".repeat(10);
                            document.getElementById('plaintext').value = testData;
                            document.getElementById('encryptionKey').value = SecureOctonion.random().toString();
                            
                            const startCrypt = performance.now();
                            encryptData();
                            const timeCrypt = performance.now() - startCrypt;
                            
                            progress.value = 90;
                            status.textContent += ` | –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ: ${timeCrypt.toFixed(2)} –º—Å`;
                            
                            // –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ
                            setTimeout(() => {
                                progress.value = 100;
                                status.textContent = "–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ";
                                
                                // –û–±–Ω–æ–≤–ª—è–µ–º –º–µ—Ç—Ä–∏–∫–∏
                                document.getElementById('opsPerSec').textContent = 
                                    `${(1000 / ((timeGen + timeEnc + timeDec + timeCrypt) / 4)).toFixed(2)}`;
                                
                                // –°–∏–º—É–ª–∏—Ä—É–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏ –∏ CPU
                                document.getElementById('memoryUsage').textContent = 
                                    `${(Math.random() * 50 + 50).toFixed(2)} MB`;
                                document.getElementById('cpuLoad').textContent = 
                                    `${(Math.random() * 30 + 20).toFixed(2)}%`;
                                
                                showAlert('–¢–µ—Å—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∑–∞–≤–µ—Ä—à—ë–Ω', 'success');
                            }, 500);
                        }, 500);
                    }, 500);
                }, 500);
            }, 500);
        }
        
        // –ó–∞–ø—É—Å–∫ –ø–æ–ª–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞
        function runFullAnalysis() {
            const resultContainer = document.getElementById('analysisResult');
            const progressContainer = document.getElementById('analysisProgressContainer');
            const progress = document.getElementById('analysisProgress');
            const status = document.getElementById('analysisStatus');
            
            resultContainer.style.display = 'none';
            progressContainer.style.display = 'block';
            progress.value = 0;
            status.textContent = "–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä–∞...";
            
            // –°–∏–º—É–ª–∏—Ä—É–µ–º –∞–Ω–∞–ª–∏–∑
            const steps = [
                "–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Å–∏—Å—Ç–µ–º—ã",
                "–ê–Ω–∞–ª–∏–∑ —Å—Ç–æ–π–∫–æ—Å—Ç–∏ –∫ –∫–≤–∞–Ω—Ç–æ–≤—ã–º –∞—Ç–∞–∫–∞–º",
                "–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–ª—É—á–∞–π–Ω—ã—Ö —á–∏—Å–µ–ª",
                "–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —É—è–∑–≤–∏–º–æ—Å—Ç–∏ –ø–æ –≤—Ä–µ–º–µ–Ω–∏",
                "–û—Ü–µ–Ω–∫–∞ —Å—Ç–æ–π–∫–æ—Å—Ç–∏ –∫ –∞–ª–≥–µ–±—Ä–∞–∏—á–µ—Å–∫–∏–º –∞—Ç–∞–∫–∞–º",
                "–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç—á—ë—Ç–∞"
            ];
            
            let currentStep = 0;
            const interval = setInterval(() => {
                if (currentStep < steps.length) {
                    progress.value = (currentStep + 1) * (100 / steps.length);
                    status.textContent = steps[currentStep];
                    currentStep++;
                } else {
                    clearInterval(interval);
                    progress.value = 100;
                    status.textContent = "–ê–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à—ë–Ω";
                    
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
                    resultContainer.style.display = 'block';
                    progressContainer.style.display = 'none';
                    
                    // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–ª—É—á–∞–π–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏
                    document.getElementById('overallScore').textContent = "85/100";
                    document.getElementById('overallScore').className = "metric-value good";
                    
                    document.getElementById('quantumResistance').textContent = "–í—ã—Å–æ–∫–∞—è";
                    document.getElementById('quantumResistance').className = "metric-value good";
                    
                    document.getElementById('classicalResistance').textContent = "–û—á–µ–Ω—å –≤—ã—Å–æ–∫–∞—è";
                    document.getElementById('classicalResistance').className = "metric-value good";
                    
                    document.getElementById('keyQuality').textContent = "–û—Ç–ª–∏—á–Ω–∞—è";
                    document.getElementById('keyQuality').className = "metric-value good";
                    
                    document.getElementById('entropyScore').textContent = "92/100";
                    document.getElementById('entropyScore').className = "metric-value good";
                    
                    document.getElementById('timingAttackResistance').textContent = "–°—Ä–µ–¥–Ω—è—è";
                    document.getElementById('timingAttackResistance').className = "metric-value fair";
                    
                    document.getElementById('recommendations').textContent = 
                        "–£–≤–µ–ª–∏—á—å—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞—É–Ω–¥–æ–≤ –¥–æ 16+ –¥–ª—è –ª—É—á—à–µ–π –∑–∞—â–∏—Ç—ã –æ—Ç timing-–∞—Ç–∞–∫";
                    
                    showAlert('–ê–Ω–∞–ª–∏–∑ –∫—Ä–∏–ø—Ç–æ—Å—Ç–æ–π–∫–æ—Å—Ç–∏ –∑–∞–≤–µ—Ä—à—ë–Ω', 'success');
                }
            }, 1000);
        }
        
        // –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ª—É—á–∞–π–Ω–æ—Å—Ç–∏
        function testRandomness() {
            try {
                const randomOctonion = SecureOctonion.random();
                const bytes = randomOctonion.toBytes();
                
                // –ü—Ä–æ—Å—Ç–æ–π —Ç–µ—Å—Ç –Ω–∞ —Å–ª—É—á–∞–π–Ω–æ—Å—Ç—å - –ø–æ–¥—Å—á–µ—Ç –±–∞–π—Ç–æ–≤
                const counts = new Array(256).fill(0);
                for (const byte of bytes) {
                    counts[byte]++;
                }
                
                // –í—ã—á–∏—Å–ª—è–µ–º —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
                let uniformity = 0;
                for (const count of counts) {
                    uniformity += Math.abs(count - bytes.length / 256);
                }
                uniformity = 100 - (uniformity / (bytes.length * 2)) * 100;
                
                document.getElementById('vulnerabilityReport').value = 
                    `–¢–µ—Å—Ç —Å–ª—É—á–∞–π–Ω–æ—Å—Ç–∏ –æ–∫—Ç–æ–Ω–∏–æ–Ω–æ–≤:\n\n` +
                    `–†–∞–≤–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è: ${uniformity.toFixed(2)}%\n` +
                    `–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ > 90% –¥–ª—è –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Ü–µ–ª–µ–π\n\n` +
                    `–ü–µ—Ä–≤—ã–µ 16 –±–∞–π—Ç: ${bytes.slice(0, 16).join(', ')}...`;
                
                showAlert('–¢–µ—Å—Ç —Å–ª—É—á–∞–π–Ω–æ—Å—Ç–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω', 'success');
            } catch (e) {
                showAlert(`–û—à–∏–±–∫–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–ª—É—á–∞–π–Ω–æ—Å—Ç–∏: ${e.message}`, 'error');
                console.error(e);
            }
        }
        
        // –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —ç–Ω—Ç—Ä–æ–ø–∏–∏
        function testEntropy() {
            try {
                const testData = "–¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —ç–Ω—Ç—Ä–æ–ø–∏–∏ " + Math.random().toString(36).substring(2);
                const encoder = new TextEncoder();
                const data = encoder.encode(testData);
                const octonions = systemState.cipher.dataToOctonions(data);
                
                let entropy = 0;
                for (const o of octonions) {
                    const bytes = o.toBytes();
                    for (const byte of bytes) {
                        const p = byte / 255;
                        if (p > 0) {
                            entropy -= p * Math.log2(p);
                        }
                    }
                }
                entropy /= octonions.length * 8;
                
                document.getElementById('vulnerabilityReport').value = 
                    `–ê–Ω–∞–ª–∏–∑ —ç–Ω—Ç—Ä–æ–ø–∏–∏:\n\n` +
                    `–°—Ä–µ–¥–Ω—è—è —ç–Ω—Ç—Ä–æ–ø–∏—è –Ω–∞ –±–∞–π—Ç: ${entropy.toFixed(4)} –±–∏—Ç\n` +
                    `–ò–¥–µ–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ: 8 –±–∏—Ç\n` +
                    `–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ > 7.5 –±–∏—Ç –¥–ª—è –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Ü–µ–ª–µ–π`;
                
                showAlert('–¢–µ—Å—Ç —ç–Ω—Ç—Ä–æ–ø–∏–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω', 'success');
            } catch (e) {
                showAlert(`–û—à–∏–±–∫–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —ç–Ω—Ç—Ä–æ–ø–∏–∏: ${e.message}`, 'error');
                console.error(e);
            }
        }
        
        // –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ side-channel —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π
        function testSideChannels() {
            // –≠—Ç–æ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è, –≤ —Ä–µ–∞–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ –Ω—É–∂–Ω—ã –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–µ —Ç–µ—Å—Ç—ã
            document.getElementById('vulnerabilityReport').value = 
                `–û—Ç—á—ë—Ç –æ side-channel —É—è–∑–≤–∏–º–æ—Å—Ç—è—Ö:\n\n` +
                `1. –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: ${systemState.settings.rounds >= 16 ? '–ó–∞—â–∏—â–µ–Ω–æ' : '–í–æ–∑–º–æ–∂–Ω—ã —É—Ç–µ—á–∫–∏'}\n` +
                `2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏: –°—Ç–∞–±–∏–ª—å–Ω–æ–µ\n` +
                `3. –≠–ª–µ–∫—Ç—Ä–æ–º–∞–≥–Ω–∏—Ç–Ω—ã–µ —É—Ç–µ—á–∫–∏: –ù–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–ª–æ—Å—å\n` +
                `4. –ê—Ç–∞–∫–∏ –ø–æ —ç–Ω–µ—Ä–≥–æ–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—é: –ù–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–ª–æ—Å—å\n\n` +
                `–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±–æ–ª—å—à–µ —Ä–∞—É–Ω–¥–æ–≤ (16+) –¥–ª—è –ª—É—á—à–µ–π –∑–∞—â–∏—Ç—ã –æ—Ç timing-–∞—Ç–∞–∫`;
            
            showAlert('–¢–µ—Å—Ç side-channel —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π –≤—ã–ø–æ–ª–Ω–µ–Ω', 'success');
        }
        
        // –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Padding Oracle
        function testPaddingOracle() {
            document.getElementById('vulnerabilityReport').value = 
                `–û—Ç—á—ë—Ç –æ Padding Oracle —É—è–∑–≤–∏–º–æ—Å—Ç—è—Ö:\n\n` +
                `–†–µ–∂–∏–º ${systemState.settings.mode}: ${
                    ['OCB', 'GCM'].includes(systemState.settings.mode) ? 
                    '–ó–∞—â–∏—â–µ–Ω–æ (–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ)' : 
                    '–í–æ–∑–º–æ–∂–Ω—ã –∞—Ç–∞–∫–∏ (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ OCB –∏–ª–∏ GCM)'
                }\n\n` +
                `–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏: –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ–∂–∏–º—ã —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è (OCB, GCM)`;
            
            showAlert('–¢–µ—Å—Ç Padding Oracle –≤—ã–ø–æ–ª–Ω–µ–Ω', 'success');
        }
        
        // –¢–µ—Å—Ç –Ω–∞ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ brute-force
        function testBruteForce() {
            const keySize = systemState.settings.keySize;
            let timeToCrack;
            
            if (keySize >= 512) {
                timeToCrack = "–ë–æ–ª–µ–µ 100 –ª–µ—Ç (–∫–≤–∞–Ω—Ç–æ–≤—ã–µ –∫–æ–º–ø—å—é—Ç–µ—Ä—ã –Ω–µ –ø–æ–º–æ–≥—É—Ç)";
            } else if (keySize >= 384) {
                timeToCrack = "–î–µ—Å—è—Ç–∫–∏ –ª–µ—Ç –¥–∞–∂–µ —Å –∫–≤–∞–Ω—Ç–æ–≤—ã–º–∏ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞–º–∏";
            } else if (keySize >= 256) {
                timeToCrack = "–ì–æ–¥—ã –Ω–∞ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏—Ö –∫–æ–º–ø—å—é—Ç–µ—Ä–∞—Ö, –º–µ—Å—è—Ü—ã –Ω–∞ –∫–≤–∞–Ω—Ç–æ–≤—ã—Ö";
            } else if (keySize >= 192) {
                timeToCrack = "–ú–µ—Å—è—Ü—ã –Ω–∞ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏—Ö –∫–æ–º–ø—å—é—Ç–µ—Ä–∞—Ö, –¥–Ω–∏ –Ω–∞ –∫–≤–∞–Ω—Ç–æ–≤—ã—Ö";
            } else {
                timeToCrack = "–ß–∞—Å—ã/–¥–Ω–∏ –Ω–∞ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏—Ö –∫–æ–º–ø—å—é—Ç–µ—Ä–∞—Ö, –º–∏–Ω—É—Ç—ã –Ω–∞ –∫–≤–∞–Ω—Ç–æ–≤—ã—Ö";
            }
            
            document.getElementById('vulnerabilityReport').value = 
                `–û—Ç—á—ë—Ç –æ–± —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏ –∫ brute-force:\n\n` +
                `–†–∞–∑–º–µ—Ä –∫–ª—é—á–∞: ${keySize} –±–∏—Ç\n` +
                `–ü—Ä–∏–º–µ—Ä–Ω–æ–µ –≤—Ä–µ–º—è –≤–∑–ª–æ–º–∞: ${timeToCrack}\n` +
                `–§–∞–∫—Ç–æ—Ä –∫–≤–∞–Ω—Ç–æ–≤–æ–≥–æ —É—Å–∫–æ—Ä–µ–Ω–∏—è: 2-4x (–∞–ª–≥–æ—Ä–∏—Ç–º –ì—Ä–æ–≤–µ—Ä–∞)\n\n` +
                `–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–ª—é—á–∏ –Ω–µ –º–µ–Ω–µ–µ 256 –±–∏—Ç –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç –∫–≤–∞–Ω—Ç–æ–≤—ã—Ö –∞—Ç–∞–∫`;
            
            showAlert('–¢–µ—Å—Ç brute-force –≤—ã–ø–æ–ª–Ω–µ–Ω', 'success');
        }
        
        // –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å AES
        function compareWithAES() {
            document.getElementById('comparisonReport').value = 
                `–°—Ä–∞–≤–Ω–µ–Ω–∏–µ OctoKEM —Å AES-${systemState.settings.keySize}:\n\n` +
                `1. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:\n` +
                `   - AES: –ü—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç, —É—Å—Ç–æ–π—á–∏–≤ –∫ –∏–∑–≤–µ—Å—Ç–Ω—ã–º –∞—Ç–∞–∫–∞–º\n` +
                `   - OctoKEM: –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏ —É—Å—Ç–æ–π—á–∏–≤ –∫ –∫–≤–∞–Ω—Ç–æ–≤—ã–º –∞—Ç–∞–∫–∞–º, –Ω–æ –º–µ–Ω–µ–µ –∏–∑—É—á–µ–Ω\n\n` +
                `2. –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:\n` +
                `   - AES: –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∞–ø–ø–∞—Ä–∞—Ç–Ω–æ–µ —É—Å–∫–æ—Ä–µ–Ω–∏–µ, –æ—á–µ–Ω—å –±—ã—Å—Ç—Ä—ã–π\n` +
                `   - OctoKEM: –ú–µ–¥–ª–µ–Ω–Ω–µ–µ –∏–∑-–∑–∞ —Å–ª–æ–∂–Ω—ã—Ö –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π\n\n` +
                `3. –ö–≤–∞–Ω—Ç–æ–≤–∞—è —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å:\n` +
                `   - AES: –£—è–∑–≤–∏–º –∫ –∞–ª–≥–æ—Ä–∏—Ç–º—É –ì—Ä–æ–≤–µ—Ä–∞ (–∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–æ–µ —É—Å–∫–æ—Ä–µ–Ω–∏–µ)\n` +
                `   - OctoKEM: –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏ —É—Å—Ç–æ–π—á–∏–≤ –±–ª–∞–≥–æ–¥–∞—Ä—è –Ω–µ–∞—Å—Å–æ—Ü–∏–∞—Ç–∏–≤–Ω–æ–π –∞–ª–≥–µ–±—Ä–µ\n\n` +
                `–í—ã–≤–æ–¥: AES –ª—É—á—à–µ –¥–ª—è –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏—Ö —Å–∏—Å—Ç–µ–º, OctoKEM - –¥–ª—è –ø–æ—Å—Ç–∫–≤–∞–Ω—Ç–æ–≤–æ–π –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏–∏`;
            
            showAlert('–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å AES –≤—ã–ø–æ–ª–Ω–µ–Ω–æ', 'success');
        }
        
        // –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å Kyber
        function compareWithKyber() {
            document.getElementById('comparisonReport').value = 
                `–°—Ä–∞–≤–Ω–µ–Ω–∏–µ OctoKEM —Å Kyber:\n\n` +
                `1. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:\n` +
                `   - Kyber: –û—Å–Ω–æ–≤–∞–Ω –Ω–∞ LWE, —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω NIST\n` +
                `   - OctoKEM: –û—Å–Ω–æ–≤–∞–Ω –Ω–∞ –æ–∫—Ç–æ–Ω–∏–æ–Ω–∞—Ö, —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π\n\n` +
                `2. –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:\n` +
                `   - Kyber: –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏\n` +
                `   - OctoKEM: –ú–µ–Ω–µ–µ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω, —Ç—Ä–µ–±—É–µ—Ç –±–æ–ª—å—à–µ —Ä–µ—Å—É—Ä—Å–æ–≤\n\n` +
                `3. –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:\n` +
                `   - Kyber: –¢–æ–ª—å–∫–æ KEM\n` +
                `   - OctoKEM: KEM + —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ\n\n` +
                `–í—ã–≤–æ–¥: Kyber - –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ, OctoKEM –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –±–æ–ª—å—à–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π`;
            
            showAlert('–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å Kyber –≤—ã–ø–æ–ª–Ω–µ–Ω–æ', 'success');
        }
        
        // –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å RSA
        function compareWithRSA() {
            document.getElementById('comparisonReport').value = 
                `–°—Ä–∞–≤–Ω–µ–Ω–∏–µ OctoKEM —Å RSA-${systemState.settings.keySize}:\n\n` +
                `1. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:\n` +
                `   - RSA: –£—è–∑–≤–∏–º –∫ –∞—Ç–∞–∫–µ –®–æ—Ä–∞ –Ω–∞ –∫–≤–∞–Ω—Ç–æ–≤—ã—Ö –∫–æ–º–ø—å—é—Ç–µ—Ä–∞—Ö\n` +
                `   - OctoKEM: –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏ —É—Å—Ç–æ–π—á–∏–≤ –∫ –∫–≤–∞–Ω—Ç–æ–≤—ã–º –∞—Ç–∞–∫–∞–º\n\n` +
                `2. –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:\n` +
                `   - RSA: –ú–µ–¥–ª–µ–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏, –æ—Å–æ–±–µ–Ω–Ω–æ –¥–ª—è –±–æ–ª—å—à–∏—Ö –∫–ª—é—á–µ–π\n` +
                `   - OctoKEM: –ë—ã—Å—Ç—Ä–µ–µ RSA –¥–ª—è —Å–æ–ø–æ—Å—Ç–∞–≤–∏–º—ã—Ö —É—Ä–æ–≤–Ω–µ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏\n\n` +
                `3. –†–∞–∑–º–µ—Ä –∫–ª—é—á–∞:\n` +
                `   - RSA: –¢—Ä–µ–±—É—é—Ç—Å—è –±–æ–ª—å—à–∏–µ –∫–ª—é—á–∏ (2048+ –±–∏—Ç –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏)\n` +
                `   - OctoKEM: –ú–µ–Ω—å—à–∏–µ –∫–ª—é—á–∏ –ø—Ä–∏ —Ç–æ–π –∂–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏\n\n` +
                `–í—ã–≤–æ–¥: RSA —É—Å—Ç–∞—Ä–µ–≤–∞–µ—Ç –≤ –ø–æ—Å—Ç–∫–≤–∞–Ω—Ç–æ–≤—É—é —ç–ø–æ—Ö—É, OctoKEM - –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–Ω–∞—è –∑–∞–º–µ–Ω–∞`;
            
            showAlert('–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å RSA –≤—ã–ø–æ–ª–Ω–µ–Ω–æ', 'success');
        }
        
        // =============================================
        // –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò
        // =============================================
        
        // –ü–æ–∫–∞–∑–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
        function showAlert(message, type = 'info') {
            const alertContainer = document.getElementById('alertContainer');
            const alertDiv = document.createElement('div');
            alertDiv.className = `alert alert-${type}`;
            
            const iconMap = {
                'success': '‚úÖ',
                'error': '‚ùå',
                'warning': '‚ö†Ô∏è',
                'info': '‚ÑπÔ∏è'
            };
            
            alertDiv.innerHTML = `<span class="icon">${iconMap[type] || ''}</span><div>${message}</div>`;
            
            alertContainer.appendChild(alertDiv);
            
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
            setTimeout(() => {
                alertDiv.classList.add('fade-out');
                setTimeout(() => {
                    alertDiv.remove();
                }, 300);
            }, 5000);
        }
        
        // –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞
        function copyToClipboard(elementId) {
            const element = document.getElementById(elementId);
            element.select();
            document.execCommand('copy');
            
            // –ü–æ–∫–∞–∑–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
            const originalText = element.value;
            element.value = "–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!";
            setTimeout(() => {
                element.value = originalText;
            }, 1000);
            
            showAlert('–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞', 'success');
        }
        
        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∫–ª–∞–¥–æ–∫
        function switchTab(tabId) {
            // –°–∫—Ä—ã—Ç—å –≤—Å–µ —Ç–∞–±—ã
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // –î–µ–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –∫–Ω–æ–ø–∫–∏ —Ç–∞–±–æ–≤
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // –ü–æ–∫–∞–∑–∞—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Ç–∞–±
            document.getElementById(tabId).classList.add('active');
            
            // –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –∫–Ω–æ–ø–∫—É —Ç–∞–±–∞
            document.querySelector(`.tab[onclick="switchTab('${tabId}')"]`).classList.add('active');
        }
        
        // –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ ArrayBuffer –≤ base64
        function arrayBufferToBase64(buffer) {
            let binary = '';
            const bytes = new Uint8Array(buffer);
            for (let i = 0; i < bytes.byteLength; i++) {
                binary += String.fromCharCode(bytes[i]);
            }
            return btoa(binary);
        }
        
        // –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ base64 –≤ ArrayBuffer
        function base64ToArrayBuffer(base64) {
            const binaryString = atob(base64);
            const bytes = new Uint8Array(binaryString.length);
            for (let i = 0; i < binaryString.length; i++) {
                bytes[i] = binaryString.charCodeAt(i);
            }
            return bytes;
        }
        
        // –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –±–∞–π—Ç–æ–≤ –≤ hex-—Å—Ç—Ä–æ–∫—É
        function bytesToHex(bytes) {
            return Array.from(bytes).map(b => b.toString(16).padStart(2, '0')).join('');
        }
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π
        function checkSystemRequirements() {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–¥–µ—Ä–∂–∫—É Web Crypto API
            if (!window.crypto || !window.crypto.subtle) {
                showAlert('–í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç Web Crypto API. –ù–µ–∫–æ—Ç–æ—Ä—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –º–æ–≥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.', 'warning');
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–¥–µ—Ä–∂–∫—É TypedArray
            if (!window.Uint8Array || !window.Float64Array) {
                showAlert('–í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç TypedArray. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –º–µ–¥–ª–µ–Ω–Ω–æ.', 'warning');
            }
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI
        function updateUI() {
            updateSecurityLevel();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –º–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
            document.getElementById('kemGenTime').textContent = `${systemState.performanceMetrics.kemGeneration.toFixed(2)} –º—Å`;
            document.getElementById('kemEncTime').textContent = `${systemState.performanceMetrics.kemEncapsulation.toFixed(2)} –º—Å`;
            document.getElementById('kemDecTime').textContent = `${systemState.performanceMetrics.kemDecapsulation.toFixed(2)} –º—Å`;
            document.getElementById('encryptTime').textContent = `${systemState.performanceMetrics.encryption.toFixed(2)} –º—Å`;
            document.getElementById('decryptTime').textContent = `${systemState.performanceMetrics.decryption.toFixed(2)} –º—Å`;
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.onload = function() {
            initSystem();
        };
    </script>
</body>
    </html>
